["{\"transientOutputs\":false,\"transientCellMetadata\":{\"breakpointMargin\":true,\"id\":false,\"metadata\":false,\"attachments\":false},\"transientDocumentMetadata\":{\"cells\":true,\"indentAmount\":true},\"cellContentMetadata\":{\"attachments\":true}}","{\"cells\":[{\"cellKind\":1,\"language\":\"markdown\",\"metadata\":{\"metadata\":{},\"id\":\"4d8fd73a\"},\"outputs\":[],\"source\":\"# Feature & Target Pipeline\\nQuick tests and evaluation on new targets/features/models\",\"internalMetadata\":{\"internalId\":\"b6cc7e85\"}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":null,\"id\":\"64b95c13\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"1f3c0373-4dc2-4855-bc98-4ceda98f7adb\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"SW1wb3J0cyBhbmQgY29uZmlndXJhdGlvbiByZWFkeQo9PT0gTG9hZGluZyAuaGlzdF9kYl8xaC5jc3YgPT09CgpJbml0aWFsIHJvd3M6IDUzLDk2MwoKPT09IEZPVU5EIElTU1VFUyAocHJpb3IgdG8gYXV0b21hdGVkIGZpeGVzKSA9PT0KCvCflLQgVEVNUE9SQUw6IE1pc3NpbmcgaG91cnM6IDEgY2FzZXMKICBNaXNzaW5nIHRpbWVzdGFtcHMgc2FtcGxlOgogICAgMjAyNS0xMS0wNCAxMzowMDowMAoK8J+UtCBEQVRBIElOVEVHUklUWTogSWRlbnRpY2FsIGNvbnNlY3V0aXZlIE9ITEMgcm93czogMTc0IGNhc2VzCiAgU2FtcGxlIGNhc2VzOgogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogIEFmZmVjdGVkIGRhdGVzIChzYW1wbGUpOiAyMDIwLTAxLTAyLCAyMDIwLTAxLTAzLCAyMDIwLTAxLTA0LCAyMDIwLTAxLTA1LCAyMDIwLTAxLTA2Cgo9PT0gQVBQTFlJTkcgQVVUT01BVEVEIEZJWEVTID09PQpBQ1RJT046IFJlc2FtcGxlZC9SZWluZGV4ZWQgdG8gNTM5NjQgaG91cmx5IGludGVydmFscyAod2FzIDUzOTYzKS4KQUNUSU9OOiBGb3J3YXJkLWZpbGxlZCBOYU5zIGFmdGVyIHJlc2FtcGxpbmcuICg1IE5hTnMgcG90ZW50aWFsbHkgZmlsbGVkIGJ5IGZmaWxsKS4KCj09PSBGSU5BTCBTVEFUVVMgKGFmdGVyIGF1dG9tYXRlZCBmaXhlcykgPT09CkRhdGFGcmFtZSBzaGFwZSBwb3N0LWZpeGVzOiAoNTM5NjQsIDUpIChPcmlnaW5hbDogKDUzOTYzLCA2KSkKRGF0ZSByYW5nZTogMjAxOS0xMC0wMSAwMDowMDowMCB0byAyMDI1LTExLTI2IDExOjAwOjAwCk5vIG51bGwgdmFsdWVzIHJlbWFpbmluZyBhZnRlciBmaXhlcy4KVG90YWwgbnVsbCB2YWx1ZXMgcmVtYWluaW5nIGFmdGVyIGZpeGVzOiAwCkxvYWRlZCByYXcgZGF0YTogKDUzOTY0LCA1KSBpbiAwLjA3cwpVc2luZyBzbGljZTogKDUzOTY0LCA1KQpIZWF2eSBjYWNoZSByZWFkeTogaGVhdnlfZmVhdHVyZXNfdjEucGtsICh0b3RhbCAxKSBpbiBjYWNoZS9oZWF2eV9mZWF0dXJlcwoK4pqgIEhlYXZ5IGNhY2hlIG5vdCBhdmFpbGFibGU7IHJ1bm5pbmcgZnVsbCBmaXQgKHNsb3dlcikKW0ZlYXR1cmVFbmdpbmVlcl0gZml0IHN0YXJ0OyByb3dzPTUzOTY0Cg==\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"source\":\"import pandas as pd\\nfrom pathlib import Path\\nfrom typing import Optional\\nimport time\\nfrom data_pipeline import load_data  # This just loads the data and cleans it\\nfrom featureEngineer import FeatureEngineer\\nfrom targetEngineer import ExpirationTargetEngineer\\nfrom ML_setup import CONFIG\\nfrom ML_general_tools import *\\nfrom pathlib import Path\\n\\nprint(\\\"Imports and configuration ready\\\")\\n\\n# Build features, targets, and combined dataframe\\nt0 = time.time()\\nraw_history = load_data(CONFIG[\\\"data\\\"][\\\"path\\\"])\\nprint(f\\\"Loaded raw data: {raw_history.shape} in {time.time()-t0:.2f}s\\\")\\n\\n# Use slice for faster testing (or use [:] for full data)\\nhistory_slice = raw_history[:]  # Last 3000 rows for faster testing\\nprint(f\\\"Using slice: {history_slice.shape}\\\")\\n\\nfeature_params = dict(CONFIG[\\\"features\\\"][\\\"params\\\"])\\nheavy_cache_cfg = CONFIG[\\\"features\\\"].get(\\\"heavy_cache\\\", {})\\nheavy_cache_root = Path(heavy_cache_cfg.get(\\\"directory\\\", \\\"cache/heavy_features\\\"))\\n\\ncurrent_output_root_str = CONFIG[\\\"output\\\"][\\\"directory\\\"]\\ncurrent_output_root_path = Path(current_output_root_str)\\n\\npaths = {\\n    \\\"root\\\": current_output_root_path,\\n    \\\"feature_selection\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"features\\\"],\\n    \\\"trained_models\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"models\\\"],\\n    \\\"hpt_studies\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"hpt\\\"],\\n    \\\"feature_cache\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"cache\\\"]\\n}\\n\\ncache_dir = heavy_cache_root\\ncache_dir.mkdir(parents=True, exist_ok=True)\\ncache_files = sorted(cache_dir.glob(\\\"heavy_features_v*.pkl\\\"))\\ncache_ready = bool(cache_files)\\nif cache_ready:\\n    print(f\\\"Heavy cache ready: {cache_files[-1].name} (total {len(cache_files)}) in {cache_dir}\\\")\\nelse:\\n    print(f\\\"No heavy cache file found in {cache_dir}; initial fit will populate.\\\")\\n\\n## Feature Engineering\\nfe = FeatureEngineer(verbose=True, **{k: v for k, v in feature_params.items() if k != \\\"verbose\\\"})\\n\\n## Cache usage\\ncache_ready = bool(cache_files)  # Use actual cache status\\ncache_ready = False\\nmanual_features = None\\nif cache_ready and fe.heavy_cache.load():\\n    print(\\\"\\\\n✓ Using heavy cache (only prev_cycle features cached)\\\")\\n    print(\\\"  Note: Rolling/stateless features still computed on-the-fly\\\")\\n    t1 = time.time()\\n    fe._heavy_payload = fe.heavy_cache.payload\\n    reference = fe._prepare_reference_frame(history_slice)\\n    fe._full_reference = reference\\n    manual_features = fe._compute_all_features(reference, build_heavy=False)\\n    fe.feature_names_out_ = manual_features.columns.tolist()\\n    fe._reference_features = manual_features\\n    print(f\\\"  Features computed in {time.time()-t1:.2f}s -> shape: {manual_features.shape}\\\")\\nelse:\\n    print(\\\"\\\\n⚠ Heavy cache not available; running full fit (slower)\\\")\\n    t1 = time.time()\\n    verbose_flag = feature_params.pop(\\\"verbose\\\", False)\\n    fe = FeatureEngineer(verbose=True, **feature_params)\\n    fe.fit(history_slice)\\n    manual_features = fe.transform(history_slice)\\n    print(f\\\"  Full fit+transform in {time.time()-t1:.2f}s -> shape: {manual_features.shape}\\\")\\n\\nfeature_engineer = fe\\nfeatures = manual_features.copy()\\n\\n## 2a. Volatility Regime Target Engineering ---\\nfrom targetEngineer import VolatilityRegimeEngineer\\n\\nprint(\\\"\\\\n--- Building Volatility Regime Targets ---\\\")\\nt2 = time.time()\\n\\nregime_engineer = VolatilityRegimeEngineer(\\n    lookback_window=24*3,    # 3 days lookback for vol\\n    seasonal_window=24*30,   # 30 days to learn patterns\\n    forward_window=24,       # 24h classification\\n    trend_std=1.2,           # 1.2 daily sigmas\\n    jump_std=3.0,            # 3.0 daily sigmas\\n    jump_speed_window=6,     # 6h window for jump detection\\n)\\n\\n# Pass raw history (has OHLC) instead of features (doesn't have OHLC)\\nregime_engineer.fit(history_slice)\\ntargets = regime_engineer.transform(history_slice)\\nprint(f\\\"Regime targets built in {time.time()-t2:.2f}s -> shape: {targets.shape}\\\")\\n\\n# Check distribution\\ndist = regime_engineer.get_regime_distribution(history_slice)\\nprint(\\\"\\\\nRegime distribution:\\\")\\nprint(dist)\\n\\n# Combine\\ncombined_df = pd.concat([features, targets], axis=1)\\nprint(f\\\"\\\\nCombined shape: {combined_df.shape}\\\")\\nprint(f\\\"Total pipeline time: {time.time()-t0:.2f}s\\\")\\n\",\"internalMetadata\":{\"executionOrder\":12,\"executionId\":\"f8f87ec5-b0f2-48fc-8504-c1b833a6bd61\",\"runStartTime\":1764186916378,\"renderDuration\":{\"vscode.builtin-renderer\":1},\"runStartTimeAdjustment\":0,\"internalId\":\"d9559027\"}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":null,\"id\":\"030f489c\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"1e433f26-e798-4901-829c-0804468fbbbd\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CkNhY2hlIG5vdCBmb3VuZCBvciBGT1JDRV9SRUJVSUxEPVRydWUgLSB3aWxsIHNhdmUgYWZ0ZXIgZmlyc3QgcnVuClRvIHVzZSBjYWNoZSBuZXh0IHRpbWU6CiAgMS4gUnVuIHRoZSBmaXJzdCBjZWxsIHdpdGggaGlzdG9yeV9zbGljZSA9IHJhd19oaXN0b3J5WzpdCiAgMi4gV2FpdCBmb3IgZmVhdHVyZXMvdGFyZ2V0cyB0byBjb21wdXRlCiAgMy4gVGhpcyBjZWxsIHdpbGwgc2F2ZSB0aGVtCiAgNC4gTmV4dCB0aW1lLCBzZXQgRk9SQ0VfUkVCVUlMRD1GYWxzZSBhbmQgc2tpcCB0aGUgZmlyc3QgY2VsbAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClNhdmluZyBjdXJyZW50IGZlYXR1cmVzIGFuZCB0YXJnZXRzIHRvIGNhY2hlLi4uCuKckyBTYXZlZCB0byBjYWNoZSBpbiAwLjQ0cwogIExvY2F0aW9uOiByZXNlYXJjaF92b2wK4pyTIFNhdmVkIHRvIGNhY2hlIGluIDAuNDRzCiAgTG9jYXRpb246IHJlc2VhcmNoX3ZvbAo=\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"mime\":\"text/plain\",\"source\":\"import pickle\\nfrom pathlib import Path\\n\\n# Define cache paths\\ncache_root = paths[\\\"root\\\"]\\ncache_root.mkdir(parents=True, exist_ok=True)\\n\\nfeature_cache = cache_root / \\\"features_cache.pkl\\\"\\ntarget_cache = cache_root / \\\"targets_cache.pkl\\\"\\ncombined_cache = cache_root / \\\"combined_cache.pkl\\\"\\n\\n# Option 1: Load from cache if exists\\nFORCE_REBUILD = False  # Set to True to rebuild from scratch\\n\\nif not FORCE_REBUILD and feature_cache.exists() and target_cache.exists():\\n    print(\\\"=\\\" * 60)\\n    print(\\\"Loading cached features and targets...\\\")\\n    t_load = time.time()\\n    \\n    with open(feature_cache, 'rb') as f:\\n        features = pickle.load(f)\\n    with open(target_cache, 'rb') as f:\\n        targets = pickle.load(f)\\n    with open(combined_cache, 'rb') as f:\\n        combined_df = pickle.load(f)\\n    \\n    print(f\\\"✓ Loaded from cache in {time.time()-t_load:.2f}s\\\")\\n    print(f\\\"  Features: {features.shape}\\\")\\n    print(f\\\"  Targets: {targets.shape}\\\")\\n    print(f\\\"  Combined: {combined_df.shape}\\\")\\n    print(f\\\"  Date range: {features.index[0]} to {features.index[-1]}\\\")\\n    print(\\\"=\\\" * 60)\\n    \\nelse:\\n    print(\\\"=\\\" * 60)\\n    print(\\\"Cache not found or FORCE_REBUILD=True - will save after first run\\\")\\n    print(\\\"To use cache next time:\\\")\\n    print(\\\"  1. Run the first cell with history_slice = raw_history[:]\\\")\\n    print(\\\"  2. Wait for features/targets to compute\\\")\\n    print(\\\"  3. This cell will save them\\\")\\n    print(\\\"  4. Next time, set FORCE_REBUILD=False and skip the first cell\\\")\\n    print(\\\"=\\\" * 60)\\n    \\n    # Save the current run to cache\\n    if 'features' in globals() and 'targets' in globals():\\n        print(\\\"\\\\nSaving current features and targets to cache...\\\")\\n        t_save = time.time()\\n        \\n        with open(feature_cache, 'wb') as f:\\n            pickle.dump(features, f)\\n        with open(target_cache, 'wb') as f:\\n            pickle.dump(targets, f)\\n        with open(combined_cache, 'wb') as f:\\n            pickle.dump(combined_df, f)\\n        \\n        print(f\\\"✓ Saved to cache in {time.time()-t_save:.2f}s\\\")\\n        print(f\\\"  Location: {cache_root}\\\")\\n    else:\\n        print(\\\"⚠ No features/targets to save yet - run the first cell first\\\")\\n\",\"internalMetadata\":{\"internalId\":\"8d03f25f\",\"runStartTimeAdjustment\":0,\"executionId\":\"611eba9d-4d5b-465d-8905-9338cb65b928\",\"runStartTime\":1764186605776,\"runEndTime\":1764186606218,\"lastRunSuccess\":true,\"executionOrder\":5,\"renderDuration\":{\"vscode.builtin-renderer\":1}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":28,\"id\":\"aea14ab6\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"6741a3fb-46d3-4516-8e3a-b44022148595\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpOYU4gQW5hbHlzaXMgaW4gRmVhdHVyZXMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKVG90YWwgZmVhdHVyZXM6IDQ1MApGZWF0dXJlcyB3aXRoIE5hTnM6IDIwNwpUb3RhbCByb3dzOiA1Mzk2NAoKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpOYU4gRmVhdHVyZXMgR3JvdXBlZCBieSBTb3VyY2U6Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClZPTCBmZWF0dXJlczogNTMgZmVhdHVyZXMsIDIsNjk3IHRvdGFsIE5hTnMKICB2b2xfZ2t5el8yODhoX3hfdHRlX3NxcnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyODggTmFOcyAoIDAuNTMlKQogIHZvbF9na3l6XzI4OGhfeF90dGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI4OCBOYU5zICggMC41MyUpCiAgdm9sX2dreXpfMjg4aF94X3R0ZV9jb3MgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjg4IE5hTnMgKCAwLjUzJSkKICB2b2xfZ2t5el8yODhoX3hfdHRlX3NpbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyODggTmFOcyAoIDAuNTMlKQogIHZvbF9na3l6XzI4OGhfeF90dGVfc3EgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI4OCBOYU5zICggMC41MyUpCgpTVE9DSCBmZWF0dXJlczogNyBmZWF0dXJlcywgMSwwMzIgdG90YWwgTmFOcwogIHN0b2NoX3Bvc18zaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE3MyBOYU5zICggMC4zMiUpCiAgc3RvY2hfcG9zXzZoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTY5IE5hTnMgKCAwLjMxJSkKICBzdG9jaF9wb3NfMTJoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNjIgTmFOcyAoIDAuMzAlKQogIHN0b2NoX3Bvc18yNGggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE1NiBOYU5zICggMC4yOSUpCiAgc3RvY2hfcG9zXzI4OGggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTQ0IE5hTnMgKCAwLjI3JSkKClZMTSBmZWF0dXJlczogMTggZmVhdHVyZXMsIDU5NyB0b3RhbCBOYU5zCiAgdmxtX3pzY29yZV8yODhoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTQ0IE5hTnMgKCAwLjI3JSkKICB2bG1fbWFfMjg4aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNDQgTmFOcyAoIDAuMjclKQogIHZsbV9tYV8xNDRoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3MiBOYU5zICggMC4xMyUpCiAgdmxtX3pzY29yZV8xNDRoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcyIE5hTnMgKCAwLjEzJSkKICB2bG1fenNjb3JlXzcyaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMzYgTmFOcyAoIDAuMDclKQoKUFJJQ0UgZmVhdHVyZXM6IDcgZmVhdHVyZXMsIDU0OSB0b3RhbCBOYU5zCiAgcHJpY2VfcmFua18yODhoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjg4IE5hTnMgKCAwLjUzJSkKICBwcmljZV9yYW5rXzE0NGggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNDQgTmFOcyAoIDAuMjclKQogIHByaWNlX3JhbmtfNzJoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3MiBOYU5zICggMC4xMyUpCiAgcHJpY2VfcmFua18yNGggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI0IE5hTnMgKCAwLjA0JSkKICBwcmljZV9yYW5rXzEyaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTIgTmFOcyAoIDAuMDIlKQoKRElTVCBmZWF0dXJlczogMTQgZmVhdHVyZXMsIDU0OCB0b3RhbCBOYU5zCiAgZGlzdF9mcm9tX2xvd18yODhoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTQ0IE5hTnMgKCAwLjI3JSkKICBkaXN0X2Zyb21faGlnaF8yODhoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNDQgTmFOcyAoIDAuMjclKQogIGRpc3RfZnJvbV9sb3dfMTQ0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3MiBOYU5zICggMC4xMyUpCiAgZGlzdF9mcm9tX2hpZ2hfMTQ0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcyIE5hTnMgKCAwLjEzJSkKICBkaXN0X2Zyb21faGlnaF83MmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMzYgTmFOcyAoIDAuMDclKQoKUFJFViBmZWF0dXJlczogNDAgZmVhdHVyZXMsIDU0MSB0b3RhbCBOYU5zCiAgcHJldl9zYXR1cmRheV9Qcm9nTWluUF94X3ZvbDI0aCAgICAgICAgICAgICAgICAgICAgICAgIDI0IE5hTnMgKCAwLjA0JSkKICBwcmV2X3N1bmRheV9Qcm9nTWF4UF94X3ZvbDI0aCAgICAgICAgICAgICAgICAgICAgICAgICAgMjQgTmFOcyAoIDAuMDQlKQogIHByZXZfc3VuZGF5X1Byb2dWbG1feF92b2wyNGggICAgICAgICAgICAgICAgICAgICAgICAgICAyNCBOYU5zICggMC4wNCUpCiAgcHJldl9zdW5kYXlfUHJvZ0FjdFBfeF92b2wyNGggICAgICAgICAgICAgICAgICAgICAgICAgIDI0IE5hTnMgKCAwLjA0JSkKICBwcmV2X3NhdHVyZGF5X1Byb2dNYXhQX3hfdm9sMjRoICAgICAgICAgICAgICAgICAgICAgICAgMjQgTmFOcyAoIDAuMDQlKQoKRVhUUkVNRSBmZWF0dXJlczogNiBmZWF0dXJlcywgMTU0IHRvdGFsIE5hTnMKICBleHRyZW1lX3Byb2IgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjYgTmFOcyAoIDAuMDUlKQogIGV4dHJlbWVfcHJvYl94X3R0ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyNiBOYU5zICggMC4wNSUpCiAgZXh0cmVtZV9wcm9iX3hfdHRlX2N1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI2IE5hTnMgKCAwLjA1JSkKICBleHRyZW1lX3Byb2JfeF90dGVfc3EgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjYgTmFOcyAoIDAuMDUlKQogIGV4dHJlbWVfcHJvYl94X3R0ZV9zcXJ0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyNiBOYU5zICggMC4wNSUpCgpMT0dSRVQgZmVhdHVyZXM6IDExIGZlYXR1cmVzLCAxNDIgdG90YWwgTmFOcwogIGxvZ3JldF83MmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3MyBOYU5zICggMC4xNCUpCiAgbG9ncmV0XzI0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI1IE5hTnMgKCAwLjA1JSkKICBsb2dyZXRfMTJoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTMgTmFOcyAoIDAuMDIlKQogIGxvZ3JldF82aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNyBOYU5zICggMC4wMSUpCiAgbG9ncmV0XzVoICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA2IE5hTnMgKCAwLjAxJSkKClJFQUxJWkVEIGZlYXR1cmVzOiAyIGZlYXR1cmVzLCAxNDIgdG90YWwgTmFOcwogIHJlYWxpemVkX3RvX2V4cGVjdGVkXzI0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3MSBOYU5zICggMC4xMyUpCiAgcmVhbGl6ZWRfdG9fZXhwZWN0ZWRfdHRlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcxIE5hTnMgKCAwLjEzJSkKCkRJU1RBTkNFIGZlYXR1cmVzOiAxIGZlYXR1cmVzLCA3MiB0b3RhbCBOYU5zCiAgZGlzdGFuY2Vfdm9sX2V4dHJlbWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcyIE5hTnMgKCAwLjEzJSkKCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KTmFOIExvY2F0aW9uIEFuYWx5c2lzIChUb3AgMTAgd29yc3QgZmVhdHVyZXMpOgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpwcmljZV9yYW5rXzI4OGg6CiAgVG90YWwgTmFOczogMjg4ICgwLjUzJSkKICBTdGFydCBOYU5zOiAyODcgKGJlZm9yZSAyMDE5LTEwLTEzIDAwOjAwOjAwKQogIE1pZGRsZSBOYU5zOiAyCiAgRW5kIE5hTnM6IC0xIChhZnRlciAyMDI1LTExLTI2IDExOjAwOjAwKQoKdm9sX2dreXpfMjg4aF94X3R0ZV9zcXJ0OgogIFRvdGFsIE5hTnM6IDI4OCAoMC41MyUpCiAgU3RhcnQgTmFOczogMjg3IChiZWZvcmUgMjAxOS0xMC0xMyAwMDowMDowMCkKICBNaWRkbGUgTmFOczogMgogIEVuZCBOYU5zOiAtMSAoYWZ0ZXIgMjAyNS0xMS0yNiAxMTowMDowMCkKCnZvbF9na3l6XzI4OGhfeF90dGU6CiAgVG90YWwgTmFOczogMjg4ICgwLjUzJSkKICBTdGFydCBOYU5zOiAyODcgKGJlZm9yZSAyMDE5LTEwLTEzIDAwOjAwOjAwKQogIE1pZGRsZSBOYU5zOiAyCiAgRW5kIE5hTnM6IC0xIChhZnRlciAyMDI1LTExLTI2IDExOjAwOjAwKQoKdm9sX2dreXpfMjg4aF94X3R0ZV9jb3M6CiAgVG90YWwgTmFOczogMjg4ICgwLjUzJSkKICBTdGFydCBOYU5zOiAyODcgKGJlZm9yZSAyMDE5LTEwLTEzIDAwOjAwOjAwKQogIE1pZGRsZSBOYU5zOiAyCiAgRW5kIE5hTnM6IC0xIChhZnRlciAyMDI1LTExLTI2IDExOjAwOjAwKQoKdm9sX2dreXpfMjg4aF94X3R0ZV9zaW46CiAgVG90YWwgTmFOczogMjg4ICgwLjUzJSkKICBTdGFydCBOYU5zOiAyODcgKGJlZm9yZSAyMDE5LTEwLTEzIDAwOjAwOjAwKQogIE1pZGRsZSBOYU5zOiAyCiAgRW5kIE5hTnM6IC0xIChhZnRlciAyMDI1LTExLTI2IDExOjAwOjAwKQoKdm9sX2dreXpfMjg4aF94X3R0ZV9zcToKICBUb3RhbCBOYU5zOiAyODggKDAuNTMlKQogIFN0YXJ0IE5hTnM6IDI4NyAoYmVmb3JlIDIwMTktMTAtMTMgMDA6MDA6MDApCiAgTWlkZGxlIE5hTnM6IDIKICBFbmQgTmFOczogLTEgKGFmdGVyIDIwMjUtMTEtMjYgMTE6MDA6MDApCgp2b2xfZ2t5el8yODhoOgogIFRvdGFsIE5hTnM6IDI4OCAoMC41MyUpCiAgU3RhcnQgTmFOczogMjg3IChiZWZvcmUgMjAxOS0xMC0xMyAwMDowMDowMCkKICBNaWRkbGUgTmFOczogMgogIEVuZCBOYU5zOiAtMSAoYWZ0ZXIgMjAyNS0xMS0yNiAxMTowMDowMCkKCnN0b2NoX3Bvc18zaDoKICBUb3RhbCBOYU5zOiAxNzMgKDAuMzIlKQogIFN0YXJ0IE5hTnM6IDAgKGJlZm9yZSAyMDE5LTEwLTAxIDAxOjAwOjAwKQogIE1pZGRsZSBOYU5zOiAxNzQKICBFbmQgTmFOczogLTEgKGFmdGVyIDIwMjUtMTEtMjYgMTE6MDA6MDApCgpzdG9jaF9wb3NfNmg6CiAgVG90YWwgTmFOczogMTY5ICgwLjMxJSkKICBTdGFydCBOYU5zOiAyIChiZWZvcmUgMjAxOS0xMC0wMSAwMzowMDowMCkKICBNaWRkbGUgTmFOczogMTY4CiAgRW5kIE5hTnM6IC0xIChhZnRlciAyMDI1LTExLTI2IDExOjAwOjAwKQoKc3RvY2hfcG9zXzEyaDoKICBUb3RhbCBOYU5zOiAxNjIgKDAuMzAlKQogIFN0YXJ0IE5hTnM6IDUgKGJlZm9yZSAyMDE5LTEwLTAxIDA2OjAwOjAwKQogIE1pZGRsZSBOYU5zOiAxNTgKICBFbmQgTmFOczogLTEgKGFmdGVyIDIwMjUtMTEtMjYgMTE6MDA6MDApCgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CkV4cGVjdGVkIE5hTiBTb3VyY2VzIChwcmV2X3dlZWtlbmQsIGVtcGlyaWNhbCwgZXRjLik6Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCnByZXZfc2F0dXJkYXkvc3VuZGF5IGZlYXR1cmVzIHdpdGggTmFOczogMjYKICBwcmV2X3NhdHVyZGF5X1Byb2dNaW5QX3hfdm9sMjRoOiAyNCBOYU5zCiAgcHJldl9zdW5kYXlfUHJvZ01heFBfeF92b2wyNGg6IDI0IE5hTnMKICBwcmV2X3N1bmRheV9Qcm9nVmxtX3hfdm9sMjRoOiAyNCBOYU5zCiAgcHJldl9zdW5kYXlfUHJvZ0FjdFBfeF92b2wyNGg6IDI0IE5hTnMKICBwcmV2X3NhdHVyZGF5X1Byb2dNYXhQX3hfdm9sMjRoOiAyNCBOYU5zCgplbXBfIChlbXBpcmljYWwpIGZlYXR1cmVzIHdpdGggTmFOczogMAoKcHJldl93ZWVrZGF5IGZlYXR1cmVzIHdpdGggTmFOczogMTMKICBwcmV2X3dlZWtkYXlfUHJvZ01pblBfeF92b2wyNGg6IDI0IE5hTnMKICBwcmV2X3dlZWtkYXlfUHJvZ01heFBfeF92b2wyNGg6IDI0IE5hTnMKICBwcmV2X3dlZWtkYXlfUHJvZ0FjdFBfeF92b2wyNGg6IDI0IE5hTnMKICBwcmV2X3dlZWtkYXlfUHJvZ1ZsbV94X3ZvbDI0aDogMjQgTmFOcwogIHByZXZfd2Vla2RheV9yYW5nZV94X3ZvbDogMTIgTmFOcwoKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSb3ctd2lzZSBOYU4gQW5hbHlzaXM6Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUm93cyB3aXRoIEFOWSBOYU5zOiA0NjAgLyA1Myw5NjQgKDAuODUlKQpGaXJzdCByb3cgd2l0aCBOYU5zOiAyMDE5LTEwLTAxIDAwOjAwOjAwCkxhc3Qgcm93IHdpdGggTmFOczogMjAyMi0xMi0xOCAxODowMDowMApDb25zZWN1dGl2ZSBOYU4gcm93cyBhdCBzdGFydDogMjg4CkNvbnNlY3V0aXZlIE5hTiByb3dzIGF0IGVuZDogMAo=\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"mime\":\"text/plain\",\"source\":\"# Comprehensive NaN analysis in features\\nprint(\\\"=\\\" * 70)\\nprint(\\\"NaN Analysis in Features\\\")\\nprint(\\\"=\\\" * 70)\\n\\n# 1. Overall NaN statistics\\nnan_counts = features.isna().sum()\\nnan_features = nan_counts[nan_counts > 0].sort_values(ascending=False)\\n\\nprint(f\\\"\\\\nTotal features: {len(features.columns)}\\\")\\nprint(f\\\"Features with NaNs: {len(nan_features)}\\\")\\nprint(f\\\"Total rows: {len(features)}\\\")\\n\\n# 2. Group NaN features by prefix to identify source\\nprint(\\\"\\\\n\\\" + \\\"=\\\" * 70)\\nprint(\\\"NaN Features Grouped by Source:\\\")\\nprint(\\\"=\\\" * 70)\\n\\nfeature_groups = {}\\nfor feat in nan_features.index:\\n    # Extract prefix (everything before first underscore or digit)\\n    if '_' in feat:\\n        prefix = feat.split('_')[0]\\n    else:\\n        prefix = 'other'\\n    \\n    if prefix not in feature_groups:\\n        feature_groups[prefix] = []\\n    feature_groups[prefix].append((feat, nan_counts[feat]))\\n\\n# Sort groups by total NaN count\\nsorted_groups = sorted(feature_groups.items(), \\n                       key=lambda x: sum(count for _, count in x[1]), \\n                       reverse=True)\\n\\nfor prefix, features_list in sorted_groups[:10]:  # Top 10 groups\\n    total_nans = sum(count for _, count in features_list)\\n    print(f\\\"\\\\n{prefix.upper()} features: {len(features_list)} features, {total_nans:,} total NaNs\\\")\\n    # Show top 5 within each group\\n    for feat, count in sorted(features_list, key=lambda x: x[1], reverse=True)[:5]:\\n        pct = (count / len(features)) * 100\\n        print(f\\\"  {feat:50s} {count:6,} NaNs ({pct:5.2f}%)\\\")\\n\\n# 3. Analyze NaN patterns (start/middle/end)\\nprint(\\\"\\\\n\\\" + \\\"=\\\" * 70)\\nprint(\\\"NaN Location Analysis (Top 10 worst features):\\\")\\nprint(\\\"=\\\" * 70)\\n\\nfor feat in nan_features.head(10).index:\\n    series = features[feat]\\n    nan_mask = series.isna()\\n    \\n    # Find first and last valid index\\n    valid_indices = series[~nan_mask].index\\n    if len(valid_indices) == 0:\\n        print(f\\\"\\\\n{feat}: ALL NaNs!\\\")\\n        continue\\n    \\n    first_valid = valid_indices[0]\\n    last_valid = valid_indices[-1]\\n    \\n    # Count NaNs at start, middle, end\\n    start_nans = nan_mask.loc[:first_valid].sum() - 1  # -1 to exclude first valid\\n    end_nans = nan_mask.loc[last_valid:].sum() - 1  # -1 to exclude last valid\\n    middle_nans = nan_mask.sum() - start_nans - end_nans\\n    \\n    print(f\\\"\\\\n{feat}:\\\")\\n    print(f\\\"  Total NaNs: {nan_mask.sum():,} ({nan_mask.sum()/len(features)*100:.2f}%)\\\")\\n    print(f\\\"  Start NaNs: {start_nans:,} (before {first_valid})\\\")\\n    print(f\\\"  Middle NaNs: {middle_nans:,}\\\")\\n    print(f\\\"  End NaNs: {end_nans:,} (after {last_valid})\\\")\\n\\n# 4. Check specific feature types that are expected\\nprint(\\\"\\\\n\\\" + \\\"=\\\" * 70)\\nprint(\\\"Expected NaN Sources (prev_weekend, empirical, etc.):\\\")\\nprint(\\\"=\\\" * 70)\\n\\nprev_weekend_features = [f for f in nan_features.index if 'prev_saturday' in f or 'prev_sunday' in f]\\nempirical_features = [f for f in nan_features.index if 'emp_' in f]\\nprev_weekday_features = [f for f in nan_features.index if 'prev_weekday' in f]\\n\\nprint(f\\\"\\\\nprev_saturday/sunday features with NaNs: {len(prev_weekend_features)}\\\")\\nif prev_weekend_features:\\n    for feat in prev_weekend_features[:5]:\\n        print(f\\\"  {feat}: {nan_counts[feat]:,} NaNs\\\")\\n\\nprint(f\\\"\\\\nemp_ (empirical) features with NaNs: {len(empirical_features)}\\\")\\nif empirical_features:\\n    for feat in empirical_features[:5]:\\n        print(f\\\"  {feat}: {nan_counts[feat]:,} NaNs\\\")\\n\\nprint(f\\\"\\\\nprev_weekday features with NaNs: {len(prev_weekday_features)}\\\")\\nif prev_weekday_features:\\n    for feat in prev_weekday_features[:5]:\\n        print(f\\\"  {feat}: {nan_counts[feat]:,} NaNs\\\")\\n\\n# 5. Check which rows have NaNs\\nprint(\\\"\\\\n\\\" + \\\"=\\\" * 70)\\nprint(\\\"Row-wise NaN Analysis:\\\")\\nprint(\\\"=\\\" * 70)\\n\\nrows_with_nans = features.isna().any(axis=1)\\nprint(f\\\"Rows with ANY NaNs: {rows_with_nans.sum():,} / {len(features):,} ({rows_with_nans.sum()/len(features)*100:.2f}%)\\\")\\n\\n# Show first and last rows with NaNs\\nnan_row_indices = features[rows_with_nans].index\\nif len(nan_row_indices) > 0:\\n    print(f\\\"First row with NaNs: {nan_row_indices[0]}\\\")\\n    print(f\\\"Last row with NaNs: {nan_row_indices[-1]}\\\")\\n    \\n    # Count consecutive NaNs at start and end\\n    consecutive_start = 0\\n    for i in range(len(rows_with_nans)):\\n        if rows_with_nans.iloc[i]:\\n            consecutive_start += 1\\n        else:\\n            break\\n    \\n    consecutive_end = 0\\n    for i in range(len(rows_with_nans)-1, -1, -1):\\n        if rows_with_nans.iloc[i]:\\n            consecutive_end += 1\\n        else:\\n            break\\n    \\n    print(f\\\"Consecutive NaN rows at start: {consecutive_start}\\\")\\n    print(f\\\"Consecutive NaN rows at end: {consecutive_end}\\\")\\n\",\"internalMetadata\":{\"internalId\":\"8809a7a5\",\"runStartTimeAdjustment\":0,\"executionId\":\"f25079d2-1f04-4b8c-b7e2-fa0d4a1b088c\",\"runStartTime\":1764182252111,\"runEndTime\":1764182252146,\"lastRunSuccess\":true,\"executionOrder\":28,\"renderDuration\":{\"vscode.builtin-renderer\":1}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":9,\"id\":\"cd8f63c2\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"ac865a40-6bfa-4dcb-88ba-acd90e05fdf2\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"TmFOIFN1bW1hcnk6CiAgRmlyc3QgdmFsaWQgcm93OiAyMDE5LTEwLTEzIDAwOjAwOjAwCiAgTGFzdCB2YWxpZCByb3c6IDIwMjUtMTEtMjYgMTA6MDA6MDAKICBTdGFydCBOYU5zIHRvIGRyb3A6IDI4NwogIEVuZCBOYU5zIHRvIGRyb3A6IDAKCkFmdGVyIHRyaW1taW5nIHN0YXJ0L2VuZDoKICBSb3dzOiA1MzY3NSAoZnJvbSAyMDE5LTEwLTEzIDAwOjAwOjAwIHRvIDIwMjUtMTEtMjYgMTA6MDA6MDApCiAgTWlkZGxlIHJvd3Mgd2l0aCBOYU5zOiA5NwogIOKaoO+4jyBXQVJOSU5HOiA5NyByb3dzIHdpdGggTmFOcyBpbiBtaWRkbGUgLSBwcmVzZXJ2ZWQgZm9yIGRlYnVnZ2luZwo=\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]},{\"outputId\":\"638882dc-ecd7-4313-91e0-701f6f9bcd08\",\"metadata\":{\"outputType\":\"execute_result\",\"executionCount\":9,\"metadata\":{}},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PGRpdj4KPHN0eWxlIHNjb3BlZD4KICAgIC5kYXRhZnJhbWUgdGJvZHkgdHIgdGg6b25seS1vZi10eXBlIHsKICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgfQoKICAgIC5kYXRhZnJhbWUgdGJvZHkgdHIgdGggewogICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgICB9CgogICAgLmRhdGFmcmFtZSB0aGVhZCB0aCB7CiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9Cjwvc3R5bGU+Cjx0YWJsZSBib3JkZXI9IjEiIGNsYXNzPSJkYXRhZnJhbWUiPgogIDx0aGVhZD4KICAgIDx0ciBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4KICAgICAgPHRoPjwvdGg+CiAgICAgIDx0aD5vPC90aD4KICAgICAgPHRoPmg8L3RoPgogICAgICA8dGg+bDwvdGg+CiAgICAgIDx0aD5jPC90aD4KICAgICAgPHRoPnZvbENjeTwvdGg+CiAgICAgIDx0aD50aW1lX3RvX2V4cDFfaHI8L3RoPgogICAgICA8dGg+dGltZV9lbGFwc2VkPC90aD4KICAgICAgPHRoPmhvdXI8L3RoPgogICAgICA8dGg+ZGF5X29mX3dlZWs8L3RoPgogICAgICA8dGg+aXNfd2Vla2VuZDwvdGg+CiAgICAgIDx0aD4uLi48L3RoPgogICAgICA8dGg+c2tld192b2xfZXh0cmVtZTwvdGg+CiAgICAgIDx0aD5rdXJ0b3Npc192b2xfZXh0cmVtZTwvdGg+CiAgICAgIDx0aD5kaXN0YW5jZV92b2xfZXh0cmVtZTwvdGg+CiAgICAgIDx0aD52b2xfc3VycHJpc2VfY2x1c3RlcmluZzwvdGg+CiAgICAgIDx0aD5yZWdpbWVfbGFiZWw8L3RoPgogICAgICA8dGg+bWF4X2Z3ZF96X3Njb3JlPC90aD4KICAgICAgPHRoPm1heF9qdW1wX3pfc2NvcmU8L3RoPgogICAgICA8dGg+Ym94X3N0ZF9kZXNlYXNvbmFsaXplZDwvdGg+CiAgICAgIDx0aD5ib3hfc3RkX3JhdzwvdGg+CiAgICAgIDx0aD5zZWFzb25hbF92b2w8L3RoPgogICAgPC90cj4KICA8L3RoZWFkPgogIDx0Ym9keT4KICAgIDx0cj4KICAgICAgPHRoPjIwMTktMTAtMTMgMDA6MDA6MDA8L3RoPgogICAgICA8dGQ+ODMwOC41PC90ZD4KICAgICAgPHRkPjgzNDEuMzwvdGQ+CiAgICAgIDx0ZD44Mjg5Ljk8L3RkPgogICAgICA8dGQ+ODMzNi43PC90ZD4KICAgICAgPHRkPjcxOC4wPC90ZD4KICAgICAgPHRkPjcuMDwvdGQ+CiAgICAgIDx0ZD4xNy4wPC90ZD4KICAgICAgPHRkPjE8L3RkPgogICAgICA8dGQ+NjwvdGQ+CiAgICAgIDx0ZD4xPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4tMC4zNjE4MzE8L3RkPgogICAgICA8dGQ+LTAuMTQxMjQyPC90ZD4KICAgICAgPHRkPjAuMDE2ODE2PC90ZD4KICAgICAgPHRkPi0yLjgxNDgwMzwvdGQ+CiAgICAgIDx0ZD4wPC90ZD4KICAgICAgPHRkPjAuNjg3MDY3PC90ZD4KICAgICAgPHRkPjEuMzc0MTM0PC90ZD4KICAgICAgPHRkPjAuMDA2NzI5PC90ZD4KICAgICAgPHRkPjAuMDA1MTM1PC90ZD4KICAgICAgPHRkPjAuMDAzNDM3PC90ZD4KICAgIDwvdHI+CiAgICA8dHI+CiAgICAgIDx0aD4yMDE5LTEwLTEzIDAxOjAwOjAwPC90aD4KICAgICAgPHRkPjgzMzYuNzwvdGQ+CiAgICAgIDx0ZD44MzY4LjU8L3RkPgogICAgICA8dGQ+ODMzNi43PC90ZD4KICAgICAgPHRkPjgzNDkuOTwvdGQ+CiAgICAgIDx0ZD43OTYuMDwvdGQ+CiAgICAgIDx0ZD42LjA8L3RkPgogICAgICA8dGQ+MTguMDwvdGQ+CiAgICAgIDx0ZD4yPC90ZD4KICAgICAgPHRkPjY8L3RkPgogICAgICA8dGQ+MTwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+LTAuMzI1MTIxPC90ZD4KICAgICAgPHRkPi0wLjIxMjA3MTwvdGQ+CiAgICAgIDx0ZD4wLjAxNTUyNDwvdGQ+CiAgICAgIDx0ZD4tMC4yMTUwMzU8L3RkPgogICAgICA8dGQ+MDwvdGQ+CiAgICAgIDx0ZD4wLjkwMTUxNTwvdGQ+CiAgICAgIDx0ZD4xLjgwMzAzMDwvdGQ+CiAgICAgIDx0ZD4wLjAwNTQ4NzwvdGQ+CiAgICAgIDx0ZD4wLjAwNTE0NzwvdGQ+CiAgICAgIDx0ZD4wLjAwNDIyNTwvdGQ+CiAgICA8L3RyPgogICAgPHRyPgogICAgICA8dGg+MjAxOS0xMC0xMyAwMjowMDowMDwvdGg+CiAgICAgIDx0ZD44MzUwLjA8L3RkPgogICAgICA8dGQ+ODM1OC42PC90ZD4KICAgICAgPHRkPjgzNDAuMDwvdGQ+CiAgICAgIDx0ZD44MzQ2Ljk8L3RkPgogICAgICA8dGQ+NDIxLjA8L3RkPgogICAgICA8dGQ+NS4wPC90ZD4KICAgICAgPHRkPjE5LjA8L3RkPgogICAgICA8dGQ+MzwvdGQ+CiAgICAgIDx0ZD42PC90ZD4KICAgICAgPHRkPjE8L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi0wLjMyOTk2OTwvdGQ+CiAgICAgIDx0ZD4tMC4yMDUxMzE8L3RkPgogICAgICA8dGQ+MC4wMTQ5NjU8L3RkPgogICAgICA8dGQ+MC4xNjkyMTA8L3RkPgogICAgICA8dGQ+MDwvdGQ+CiAgICAgIDx0ZD4wLjcyMDk3MjwvdGQ+CiAgICAgIDx0ZD4xLjQ0MTk0NTwvdGQ+CiAgICAgIDx0ZD4wLjAwNjc1OTwvdGQ+CiAgICAgIDx0ZD4wLjAwNTEzMjwvdGQ+CiAgICAgIDx0ZD4wLjAwMzQyMDwvdGQ+CiAgICA8L3RyPgogICAgPHRyPgogICAgICA8dGg+MjAxOS0xMC0xMyAwMzowMDowMDwvdGg+CiAgICAgIDx0ZD44MzQ2Ljk8L3RkPgogICAgICA8dGQ+ODM0OC4wPC90ZD4KICAgICAgPHRkPjgzNDAuMDwvdGQ+CiAgICAgIDx0ZD44MzQ1LjA8L3RkPgogICAgICA8dGQ+MTU0LjA8L3RkPgogICAgICA8dGQ+NC4wPC90ZD4KICAgICAgPHRkPjIwLjA8L3RkPgogICAgICA8dGQ+NDwvdGQ+CiAgICAgIDx0ZD42PC90ZD4KICAgICAgPHRkPjE8L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi0wLjMzMDAxNjwvdGQ+CiAgICAgIDx0ZD4tMC4yMjUzMTg8L3RkPgogICAgICA8dGQ+MC4wMTUwNDA8L3RkPgogICAgICA8dGQ+LTEuMzIyODAyPC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+MC42MzgzMDA8L3RkPgogICAgICA8dGQ+MS4yNzY2MDA8L3RkPgogICAgICA8dGQ+MC4wMDc1NjE8L3RkPgogICAgICA8dGQ+MC4wMDUxMTA8L3RkPgogICAgICA8dGQ+MC4wMDMwNDQ8L3RkPgogICAgPC90cj4KICAgIDx0cj4KICAgICAgPHRoPjIwMTktMTAtMTMgMDQ6MDA6MDA8L3RoPgogICAgICA8dGQ+ODM0NS4wPC90ZD4KICAgICAgPHRkPjgzNjMuNDwvdGQ+CiAgICAgIDx0ZD44MzQxLjE8L3RkPgogICAgICA8dGQ+ODM0MS43PC90ZD4KICAgICAgPHRkPjU3Ni4wPC90ZD4KICAgICAgPHRkPjMuMDwvdGQ+CiAgICAgIDx0ZD4yMS4wPC90ZD4KICAgICAgPHRkPjU8L3RkPgogICAgICA8dGQ+NjwvdGQ+CiAgICAgIDx0ZD4xPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4tMC4zNjQ4MDE8L3RkPgogICAgICA8dGQ+LTAuMjMyMjAyPC90ZD4KICAgICAgPHRkPjAuMDE1MTg4PC90ZD4KICAgICAgPHRkPi0zLjE3NTgyODwvdGQ+CiAgICAgIDx0ZD4wPC90ZD4KICAgICAgPHRkPjAuNzg4NDYyPC90ZD4KICAgICAgPHRkPjEuNTc2OTIzPC90ZD4KICAgICAgPHRkPjAuMDA2MDE5PC90ZD4KICAgICAgPHRkPjAuMDA1MTA3PC90ZD4KICAgICAgPHRkPjAuMDAzODIyPC90ZD4KICAgIDwvdHI+CiAgICA8dHI+CiAgICAgIDx0aD4uLi48L3RoPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgPC90cj4KICAgIDx0cj4KICAgICAgPHRoPjIwMjUtMTEtMjYgMDY6MDA6MDA8L3RoPgogICAgICA8dGQ+ODc0NTIuNTwvdGQ+CiAgICAgIDx0ZD44NzgyNy4zPC90ZD4KICAgICAgPHRkPjg3MzgzLjQ8L3RkPgogICAgICA8dGQ+ODc3MzMuOTwvdGQ+CiAgICAgIDx0ZD4zMzguMDwvdGQ+CiAgICAgIDx0ZD4xLjA8L3RkPgogICAgICA8dGQ+MjMuMDwvdGQ+CiAgICAgIDx0ZD43PC90ZD4KICAgICAgPHRkPjI8L3RkPgogICAgICA8dGQ+MDwvdGQ+CiAgICAgIDx0ZD4uLi48L3RkPgogICAgICA8dGQ+MC4wMDUzOTI8L3RkPgogICAgICA8dGQ+LTEuMzI5MTkyPC90ZD4KICAgICAgPHRkPjAuMDMyMDkwPC90ZD4KICAgICAgPHRkPi05LjMxNDU2ODwvdGQ+CiAgICAgIDx0ZD4wPC90ZD4KICAgICAgPHRkPjAuMzkxMTY1PC90ZD4KICAgICAgPHRkPjAuMDAwMDAwPC90ZD4KICAgICAgPHRkPjAuMDA2ODE0PC90ZD4KICAgICAgPHRkPjAuMDA1NTExPC90ZD4KICAgICAgPHRkPjAuMDAzNjQzPC90ZD4KICAgIDwvdHI+CiAgICA8dHI+CiAgICAgIDx0aD4yMDI1LTExLTI2IDA3OjAwOjAwPC90aD4KICAgICAgPHRkPjg3NzI1LjI8L3RkPgogICAgICA8dGQ+ODc5MDAuMDwvdGQ+CiAgICAgIDx0ZD44NzYzNy43PC90ZD4KICAgICAgPHRkPjg3ODcyLjY8L3RkPgogICAgICA8dGQ+MTk1LjA8L3RkPgogICAgICA8dGQ+MjQuMDwvdGQ+CiAgICAgIDx0ZD4wLjA8L3RkPgogICAgICA8dGQ+ODwvdGQ+CiAgICAgIDx0ZD4yPC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPjAuMDEzOTAzPC90ZD4KICAgICAgPHRkPi0xLjE0OTM5NTwvdGQ+CiAgICAgIDx0ZD4wLjAyODA2ODwvdGQ+CiAgICAgIDx0ZD4tMS45NzIwNDA8L3RkPgogICAgICA8dGQ+MDwvdGQ+CiAgICAgIDx0ZD4wLjQ2NzM3MzwvdGQ+CiAgICAgIDx0ZD4wLjAwMDAwMDwvdGQ+CiAgICAgIDx0ZD4wLjAwNjM5MzwvdGQ+CiAgICAgIDx0ZD4wLjAwNTQ4MzwvdGQ+CiAgICAgIDx0ZD4wLjAwMzg2MzwvdGQ+CiAgICA8L3RyPgogICAgPHRyPgogICAgICA8dGg+MjAyNS0xMS0yNiAwODowMDowMDwvdGg+CiAgICAgIDx0ZD44Nzg3Mi43PC90ZD4KICAgICAgPHRkPjg3ODgxLjg8L3RkPgogICAgICA8dGQ+ODczNDIuOTwvdGQ+CiAgICAgIDx0ZD44NzM2MS43PC90ZD4KICAgICAgPHRkPjIzMi4wPC90ZD4KICAgICAgPHRkPjIzLjA8L3RkPgogICAgICA8dGQ+MS4wPC90ZD4KICAgICAgPHRkPjk8L3RkPgogICAgICA8dGQ+MjwvdGQ+CiAgICAgIDx0ZD4wPC90ZD4KICAgICAgPHRkPi4uLjwvdGQ+CiAgICAgIDx0ZD4wLjAxNDU3MjwvdGQ+CiAgICAgIDx0ZD4tMS4xMTUyNDI8L3RkPgogICAgICA8dGQ+MC4wMjY5NzI8L3RkPgogICAgICA8dGQ+LTYuMzE4NjkxPC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+MC4yNDk1MDE8L3RkPgogICAgICA8dGQ+MC4wMDAwMDA8L3RkPgogICAgICA8dGQ+MC4wMDcyMDQ8L3RkPgogICAgICA8dGQ+MC4wMDU0ODE8L3RkPgogICAgICA8dGQ+MC4wMDM0Mjc8L3RkPgogICAgPC90cj4KICAgIDx0cj4KICAgICAgPHRoPjIwMjUtMTEtMjYgMDk6MDA6MDA8L3RoPgogICAgICA8dGQ+ODczNTMuNTwvdGQ+CiAgICAgIDx0ZD44NzM5Ni43PC90ZD4KICAgICAgPHRkPjg2NjI3Ljk8L3RkPgogICAgICA8dGQ+ODY3NzYuMjwvdGQ+CiAgICAgIDx0ZD41NjcuMDwvdGQ+CiAgICAgIDx0ZD4yMi4wPC90ZD4KICAgICAgPHRkPjIuMDwvdGQ+CiAgICAgIDx0ZD4xMDwvdGQ+CiAgICAgIDx0ZD4yPC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi0wLjA1NDc5NzwvdGQ+CiAgICAgIDx0ZD4tMS4xMzk1NDQ8L3RkPgogICAgICA8dGQ+MC4wMzAxMjY8L3RkPgogICAgICA8dGQ+LTQuOTg5Mzc2PC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+MC4wOTI3MjA8L3RkPgogICAgICA8dGQ+MC4wMDAwMDA8L3RkPgogICAgICA8dGQ+MC4wMDU2Njg8L3RkPgogICAgICA8dGQ+MC4wMDU0OTU8L3RkPgogICAgICA8dGQ+MC4wMDQzNjc8L3RkPgogICAgPC90cj4KICAgIDx0cj4KICAgICAgPHRoPjIwMjUtMTEtMjYgMTA6MDA6MDA8L3RoPgogICAgICA8dGQ+ODY3NzIuMjwvdGQ+CiAgICAgIDx0ZD44Njk5OS45PC90ZD4KICAgICAgPHRkPjg2NTk1Ljg8L3RkPgogICAgICA8dGQ+ODY4NzkuNzwvdGQ+CiAgICAgIDx0ZD4xOTUuMDwvdGQ+CiAgICAgIDx0ZD4yMS4wPC90ZD4KICAgICAgPHRkPjMuMDwvdGQ+CiAgICAgIDx0ZD4xMTwvdGQ+CiAgICAgIDx0ZD4yPC90ZD4KICAgICAgPHRkPjA8L3RkPgogICAgICA8dGQ+Li4uPC90ZD4KICAgICAgPHRkPi0wLjEwODAzMzwvdGQ+CiAgICAgIDx0ZD4tMC45ODU5MjM8L3RkPgogICAgICA8dGQ+MC4wMzM2NDM8L3RkPgogICAgICA8dGQ+Ny4xMzAyNzI8L3RkPgogICAgICA8dGQ+MDwvdGQ+CiAgICAgIDx0ZD4wLjAxNzQ2MTwvdGQ+CiAgICAgIDx0ZD4wLjAwMDAwMDwvdGQ+CiAgICAgIDx0ZD4wLjAwODE5ODwvdGQ+CiAgICAgIDx0ZD4wLjAwNTUwMzwvdGQ+CiAgICAgIDx0ZD4wLjAwMzAyMzwvdGQ+CiAgICA8L3RyPgogIDwvdGJvZHk+CjwvdGFibGU+CjxwPjUzNjc1IHJvd3Mgw5cgNDU2IGNvbHVtbnM8L3A+CjwvZGl2Pg==\"},\"mime\":\"text/html\"},{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"ICAgICAgICAgICAgICAgICAgICAgICAgICAgbyAgICAgICAgaCAgICAgICAgbCAgICAgICAgYyAgdm9sQ2N5ICBcCjIwMTktMTAtMTMgMDA6MDA6MDAgICA4MzA4LjUgICA4MzQxLjMgICA4Mjg5LjkgICA4MzM2LjcgICA3MTguMCAgIAoyMDE5LTEwLTEzIDAxOjAwOjAwICAgODMzNi43ICAgODM2OC41ICAgODMzNi43ICAgODM0OS45ICAgNzk2LjAgICAKMjAxOS0xMC0xMyAwMjowMDowMCAgIDgzNTAuMCAgIDgzNTguNiAgIDgzNDAuMCAgIDgzNDYuOSAgIDQyMS4wICAgCjIwMTktMTAtMTMgMDM6MDA6MDAgICA4MzQ2LjkgICA4MzQ4LjAgICA4MzQwLjAgICA4MzQ1LjAgICAxNTQuMCAgIAoyMDE5LTEwLTEzIDA0OjAwOjAwICAgODM0NS4wICAgODM2My40ICAgODM0MS4xICAgODM0MS43ICAgNTc2LjAgICAKLi4uICAgICAgICAgICAgICAgICAgICAgIC4uLiAgICAgIC4uLiAgICAgIC4uLiAgICAgIC4uLiAgICAgLi4uICAgCjIwMjUtMTEtMjYgMDY6MDA6MDAgIDg3NDUyLjUgIDg3ODI3LjMgIDg3MzgzLjQgIDg3NzMzLjkgICAzMzguMCAgIAoyMDI1LTExLTI2IDA3OjAwOjAwICA4NzcyNS4yICA4NzkwMC4wICA4NzYzNy43ICA4Nzg3Mi42ICAgMTk1LjAgICAKMjAyNS0xMS0yNiAwODowMDowMCAgODc4NzIuNyAgODc4ODEuOCAgODczNDIuOSAgODczNjEuNyAgIDIzMi4wICAgCjIwMjUtMTEtMjYgMDk6MDA6MDAgIDg3MzUzLjUgIDg3Mzk2LjcgIDg2NjI3LjkgIDg2Nzc2LjIgICA1NjcuMCAgIAoyMDI1LTExLTI2IDEwOjAwOjAwICA4Njc3Mi4yICA4Njk5OS45ICA4NjU5NS44ICA4Njg3OS43ICAgMTk1LjAgICAKCiAgICAgICAgICAgICAgICAgICAgIHRpbWVfdG9fZXhwMV9ociAgdGltZV9lbGFwc2VkICBob3VyICBkYXlfb2Zfd2VlayAgXAoyMDE5LTEwLTEzIDAwOjAwOjAwICAgICAgICAgICAgICA3LjAgICAgICAgICAgMTcuMCAgICAgMSAgICAgICAgICAgIDYgICAKMjAxOS0xMC0xMyAwMTowMDowMCAgICAgICAgICAgICAgNi4wICAgICAgICAgIDE4LjAgICAgIDIgICAgICAgICAgICA2ICAgCjIwMTktMTAtMTMgMDI6MDA6MDAgICAgICAgICAgICAgIDUuMCAgICAgICAgICAxOS4wICAgICAzICAgICAgICAgICAgNiAgIAoyMDE5LTEwLTEzIDAzOjAwOjAwICAgICAgICAgICAgICA0LjAgICAgICAgICAgMjAuMCAgICAgNCAgICAgICAgICAgIDYgICAKMjAxOS0xMC0xMyAwNDowMDowMCAgICAgICAgICAgICAgMy4wICAgICAgICAgIDIxLjAgICAgIDUgICAgICAgICAgICA2ICAgCi4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLiAgICAgICAgICAgLi4uICAgLi4uICAgICAgICAgIC4uLiAgIAoyMDI1LTExLTI2IDA2OjAwOjAwICAgICAgICAgICAgICAxLjAgICAgICAgICAgMjMuMCAgICAgNyAgICAgICAgICAgIDIgICAKMjAyNS0xMS0yNiAwNzowMDowMCAgICAgICAgICAgICAyNC4wICAgICAgICAgICAwLjAgICAgIDggICAgICAgICAgICAyICAgCjIwMjUtMTEtMjYgMDg6MDA6MDAgICAgICAgICAgICAgMjMuMCAgICAgICAgICAgMS4wICAgICA5ICAgICAgICAgICAgMiAgIAoyMDI1LTExLTI2IDA5OjAwOjAwICAgICAgICAgICAgIDIyLjAgICAgICAgICAgIDIuMCAgICAxMCAgICAgICAgICAgIDIgICAKMjAyNS0xMS0yNiAxMDowMDowMCAgICAgICAgICAgICAyMS4wICAgICAgICAgICAzLjAgICAgMTEgICAgICAgICAgICAyICAgCgogICAgICAgICAgICAgICAgICAgICBpc193ZWVrZW5kICAuLi4gIHNrZXdfdm9sX2V4dHJlbWUgIGt1cnRvc2lzX3ZvbF9leHRyZW1lICBcCjIwMTktMTAtMTMgMDA6MDA6MDAgICAgICAgICAgIDEgIC4uLiAgICAgICAgIC0wLjM2MTgzMSAgICAgICAgICAgICAtMC4xNDEyNDIgICAKMjAxOS0xMC0xMyAwMTowMDowMCAgICAgICAgICAgMSAgLi4uICAgICAgICAgLTAuMzI1MTIxICAgICAgICAgICAgIC0wLjIxMjA3MSAgIAoyMDE5LTEwLTEzIDAyOjAwOjAwICAgICAgICAgICAxICAuLi4gICAgICAgICAtMC4zMjk5NjkgICAgICAgICAgICAgLTAuMjA1MTMxICAgCjIwMTktMTAtMTMgMDM6MDA6MDAgICAgICAgICAgIDEgIC4uLiAgICAgICAgIC0wLjMzMDAxNiAgICAgICAgICAgICAtMC4yMjUzMTggICAKMjAxOS0xMC0xMyAwNDowMDowMCAgICAgICAgICAgMSAgLi4uICAgICAgICAgLTAuMzY0ODAxICAgICAgICAgICAgIC0wLjIzMjIwMiAgIAouLi4gICAgICAgICAgICAgICAgICAgICAgICAgLi4uICAuLi4gICAgICAgICAgICAgICAuLi4gICAgICAgICAgICAgICAgICAgLi4uICAgCjIwMjUtMTEtMjYgMDY6MDA6MDAgICAgICAgICAgIDAgIC4uLiAgICAgICAgICAwLjAwNTM5MiAgICAgICAgICAgICAtMS4zMjkxOTIgICAKMjAyNS0xMS0yNiAwNzowMDowMCAgICAgICAgICAgMCAgLi4uICAgICAgICAgIDAuMDEzOTAzICAgICAgICAgICAgIC0xLjE0OTM5NSAgIAoyMDI1LTExLTI2IDA4OjAwOjAwICAgICAgICAgICAwICAuLi4gICAgICAgICAgMC4wMTQ1NzIgICAgICAgICAgICAgLTEuMTE1MjQyICAgCjIwMjUtMTEtMjYgMDk6MDA6MDAgICAgICAgICAgIDAgIC4uLiAgICAgICAgIC0wLjA1NDc5NyAgICAgICAgICAgICAtMS4xMzk1NDQgICAKMjAyNS0xMS0yNiAxMDowMDowMCAgICAgICAgICAgMCAgLi4uICAgICAgICAgLTAuMTA4MDMzICAgICAgICAgICAgIC0wLjk4NTkyMyAgIAoKICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2Vfdm9sX2V4dHJlbWUgIHZvbF9zdXJwcmlzZV9jbHVzdGVyaW5nICBcCjIwMTktMTAtMTMgMDA6MDA6MDAgICAgICAgICAgICAgIDAuMDE2ODE2ICAgICAgICAgICAgICAgIC0yLjgxNDgwMyAgIAoyMDE5LTEwLTEzIDAxOjAwOjAwICAgICAgICAgICAgICAwLjAxNTUyNCAgICAgICAgICAgICAgICAtMC4yMTUwMzUgICAKMjAxOS0xMC0xMyAwMjowMDowMCAgICAgICAgICAgICAgMC4wMTQ5NjUgICAgICAgICAgICAgICAgIDAuMTY5MjEwICAgCjIwMTktMTAtMTMgMDM6MDA6MDAgICAgICAgICAgICAgIDAuMDE1MDQwICAgICAgICAgICAgICAgIC0xLjMyMjgwMiAgIAoyMDE5LTEwLTEzIDA0OjAwOjAwICAgICAgICAgICAgICAwLjAxNTE4OCAgICAgICAgICAgICAgICAtMy4xNzU4MjggICAKLi4uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi4gICAgICAgICAgICAgICAgICAgICAgLi4uICAgCjIwMjUtMTEtMjYgMDY6MDA6MDAgICAgICAgICAgICAgIDAuMDMyMDkwICAgICAgICAgICAgICAgIC05LjMxNDU2OCAgIAoyMDI1LTExLTI2IDA3OjAwOjAwICAgICAgICAgICAgICAwLjAyODA2OCAgICAgICAgICAgICAgICAtMS45NzIwNDAgICAKMjAyNS0xMS0yNiAwODowMDowMCAgICAgICAgICAgICAgMC4wMjY5NzIgICAgICAgICAgICAgICAgLTYuMzE4NjkxICAgCjIwMjUtMTEtMjYgMDk6MDA6MDAgICAgICAgICAgICAgIDAuMDMwMTI2ICAgICAgICAgICAgICAgIC00Ljk4OTM3NiAgIAoyMDI1LTExLTI2IDEwOjAwOjAwICAgICAgICAgICAgICAwLjAzMzY0MyAgICAgICAgICAgICAgICAgNy4xMzAyNzIgICAKCiAgICAgICAgICAgICAgICAgICAgIHJlZ2ltZV9sYWJlbCAgbWF4X2Z3ZF96X3Njb3JlICBtYXhfanVtcF96X3Njb3JlICBcCjIwMTktMTAtMTMgMDA6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuNjg3MDY3ICAgICAgICAgIDEuMzc0MTM0ICAgCjIwMTktMTAtMTMgMDE6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuOTAxNTE1ICAgICAgICAgIDEuODAzMDMwICAgCjIwMTktMTAtMTMgMDI6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuNzIwOTcyICAgICAgICAgIDEuNDQxOTQ1ICAgCjIwMTktMTAtMTMgMDM6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuNjM4MzAwICAgICAgICAgIDEuMjc2NjAwICAgCjIwMTktMTAtMTMgMDQ6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuNzg4NDYyICAgICAgICAgIDEuNTc2OTIzICAgCi4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLiAgICAgICAgICAgICAgLi4uICAgICAgICAgICAgICAgLi4uICAgCjIwMjUtMTEtMjYgMDY6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuMzkxMTY1ICAgICAgICAgIDAuMDAwMDAwICAgCjIwMjUtMTEtMjYgMDc6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuNDY3MzczICAgICAgICAgIDAuMDAwMDAwICAgCjIwMjUtMTEtMjYgMDg6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuMjQ5NTAxICAgICAgICAgIDAuMDAwMDAwICAgCjIwMjUtMTEtMjYgMDk6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuMDkyNzIwICAgICAgICAgIDAuMDAwMDAwICAgCjIwMjUtMTEtMjYgMTA6MDA6MDAgICAgICAgICAgICAgMCAgICAgICAgIDAuMDE3NDYxICAgICAgICAgIDAuMDAwMDAwICAgCgogICAgICAgICAgICAgICAgICAgICBib3hfc3RkX2Rlc2Vhc29uYWxpemVkICBib3hfc3RkX3JhdyAgc2Vhc29uYWxfdm9sICAKMjAxOS0xMC0xMyAwMDowMDowMCAgICAgICAgICAgICAgICAwLjAwNjcyOSAgICAgMC4wMDUxMzUgICAgICAwLjAwMzQzNyAgCjIwMTktMTAtMTMgMDE6MDA6MDAgICAgICAgICAgICAgICAgMC4wMDU0ODcgICAgIDAuMDA1MTQ3ICAgICAgMC4wMDQyMjUgIAoyMDE5LTEwLTEzIDAyOjAwOjAwICAgICAgICAgICAgICAgIDAuMDA2NzU5ICAgICAwLjAwNTEzMiAgICAgIDAuMDAzNDIwICAKMjAxOS0xMC0xMyAwMzowMDowMCAgICAgICAgICAgICAgICAwLjAwNzU2MSAgICAgMC4wMDUxMTAgICAgICAwLjAwMzA0NCAgCjIwMTktMTAtMTMgMDQ6MDA6MDAgICAgICAgICAgICAgICAgMC4wMDYwMTkgICAgIDAuMDA1MTA3ICAgICAgMC4wMDM4MjIgIAouLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uICAgICAgICAgIC4uLiAgICAgICAgICAgLi4uICAKMjAyNS0xMS0yNiAwNjowMDowMCAgICAgICAgICAgICAgICAwLjAwNjgxNCAgICAgMC4wMDU1MTEgICAgICAwLjAwMzY0MyAgCjIwMjUtMTEtMjYgMDc6MDA6MDAgICAgICAgICAgICAgICAgMC4wMDYzOTMgICAgIDAuMDA1NDgzICAgICAgMC4wMDM4NjMgIAoyMDI1LTExLTI2IDA4OjAwOjAwICAgICAgICAgICAgICAgIDAuMDA3MjA0ICAgICAwLjAwNTQ4MSAgICAgIDAuMDAzNDI3ICAKMjAyNS0xMS0yNiAwOTowMDowMCAgICAgICAgICAgICAgICAwLjAwNTY2OCAgICAgMC4wMDU0OTUgICAgICAwLjAwNDM2NyAgCjIwMjUtMTEtMjYgMTA6MDA6MDAgICAgICAgICAgICAgICAgMC4wMDgxOTggICAgIDAuMDA1NTAzICAgICAgMC4wMDMwMjMgIAoKWzUzNjc1IHJvd3MgeCA0NTYgY29sdW1uc10=\"},\"mime\":\"text/plain\"}]}],\"mime\":\"text/plain\",\"source\":\"# Clean combined dataframe - only drop start and end NaNs, preserve middle for debugging\\n# From analysis: 288 consecutive NaN rows at start, 0 at end\\n\\nrows_with_nans = combined_df.isna().any(axis=1)\\n\\n# Find first and last valid rows\\nvalid_rows = ~rows_with_nans\\nvalid_indices = combined_df[valid_rows].index\\n\\nif len(valid_indices) > 0:\\n    first_valid = valid_indices[0]\\n    last_valid = valid_indices[-1]\\n    \\n    # Count start and end NaNs\\n    start_nans = rows_with_nans.loc[:first_valid].sum() - 1\\n    end_nans = rows_with_nans.loc[last_valid:].sum() - 1\\n    \\n    print(f\\\"NaN Summary:\\\")\\n    print(f\\\"  First valid row: {first_valid}\\\")\\n    print(f\\\"  Last valid row: {last_valid}\\\")\\n    print(f\\\"  Start NaNs to drop: {start_nans}\\\")\\n    print(f\\\"  End NaNs to drop: {max(0, end_nans)}\\\")\\n    \\n    # Slice from first valid to last valid (inclusive)\\n    combined_df_clean = combined_df.loc[first_valid:last_valid].copy()\\n    \\n    # Check for middle NaNs (these are preserved for inspection)\\n    middle_nans = combined_df_clean.isna().any(axis=1).sum()\\n    \\n    print(f\\\"\\\\nAfter trimming start/end:\\\")\\n    print(f\\\"  Rows: {len(combined_df_clean)} (from {combined_df_clean.index[0]} to {combined_df_clean.index[-1]})\\\")\\n    print(f\\\"  Middle rows with NaNs: {middle_nans}\\\")\\n    \\n    if middle_nans > 0:\\n        print(f\\\"  ⚠️ WARNING: {middle_nans} rows with NaNs in middle - preserved for debugging\\\")\\nelse:\\n    print(\\\"No valid rows found!\\\")\\n    combined_df_clean = combined_df.iloc[0:0]  # Empty dataframe\\n\\ncombined_df_clean\",\"internalMetadata\":{\"internalId\":\"e05fb42e\",\"runStartTimeAdjustment\":0,\"executionId\":\"1d10b816-3ef6-4de3-b0e4-db94f40914d6\",\"runStartTime\":1764186715106,\"runEndTime\":1764186715237,\"lastRunSuccess\":true,\"executionOrder\":9,\"renderDuration\":{\"vscode.builtin-renderer\":4}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":7,\"id\":\"18260009\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"96062d86-8e85-424b-8318-529fb4eeffa7\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpBbmFseXppbmcgTWlkZGxlIE5hTiBGZWF0dXJlcwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpGZWF0dXJlcyB3aXRoIG1pZGRsZSBOYU5zOiA0CgpUb3AgMjAgZmVhdHVyZXMgYnkgTmFOIGNvdW50OgogIHJlZ2ltZV9sYWJlbCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA5NiBOYU5zICggMC4xOCUpCiAgbWF4X2Z3ZF96X3Njb3JlICAgICAgICAgICAgICAgICAgICAgICAgICAgIDk2IE5hTnMgKCAwLjE4JSkKICBtYXhfanVtcF96X3Njb3JlICAgICAgICAgICAgICAgICAgICAgICAgICAgOTYgTmFOcyAoIDAuMTglKQogIHZvbF9yYXRpb18yNGhfMTQ0aCAgICAgICAgICAgICAgICAgICAgICAgICAyMyBOYU5zICggMC4wNCUpCgpHcm91cGVkIGJ5IGZlYXR1cmUgdHlwZToKICBtYXggICAgICAgICAgICAgICAgICAgICAxOTIgdG90YWwgTmFOcwogIHJlZ2ltZSAgICAgICAgICAgICAgICAgICA5NiB0b3RhbCBOYU5zCiAgdm9sICAgICAgICAgICAgICAgICAgICAgIDIzIHRvdGFsIE5hTnMKClN0b2NoYXN0aWMgZmVhdHVyZXMgd2l0aCBOYU5zOiAwCiAg4pyTIE5vIHN0b2NoYXN0aWMgTmFOcyAtIGZpeCBpcyB3b3JraW5nIQoKRGF0ZSByYW5nZSBvZiBtaWRkbGUgTmFOczoKICBGaXJzdDogMjAyMC0wMS0wNSAxNjowMDowMAogIExhc3Q6IDIwMjAtMDEtMDkgMTY6MDA6MDAK\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"source\":\"# Analyze which features have the middle NaNs and verify stochastic fix\\nif 'combined_df_clean' in globals() and len(combined_df_clean) > 0:\\n    print(\\\"=\\\" * 70)\\n    print(\\\"Analyzing Middle NaN Features\\\")\\n    print(\\\"=\\\" * 70)\\n    \\n    # Get rows with NaNs\\n    rows_with_middle_nans = combined_df_clean.isna().any(axis=1)\\n    \\n    if rows_with_middle_nans.sum() > 0:\\n        # Count NaNs per feature\\n        middle_nan_counts = combined_df_clean.isna().sum()\\n        features_with_middle_nans = middle_nan_counts[middle_nan_counts > 0].sort_values(ascending=False)\\n        \\n        print(f\\\"\\\\nFeatures with middle NaNs: {len(features_with_middle_nans)}\\\")\\n        print(f\\\"\\\\nTop 20 features by NaN count:\\\")\\n        for feat, count in features_with_middle_nans.head(20).items():\\n            pct = (count / len(combined_df_clean)) * 100\\n            print(f\\\"  {feat:40s} {count:4d} NaNs ({pct:5.2f}%)\\\")\\n        \\n        # Group by prefix\\n        print(f\\\"\\\\nGrouped by feature type:\\\")\\n        feature_groups = {}\\n        for feat in features_with_middle_nans.index:\\n            prefix = feat.split('_')[0] if '_' in feat else 'other'\\n            if prefix not in feature_groups:\\n                feature_groups[prefix] = 0\\n            feature_groups[prefix] += features_with_middle_nans[feat]\\n        \\n        for prefix, total_nans in sorted(feature_groups.items(), key=lambda x: x[1], reverse=True):\\n            print(f\\\"  {prefix:20s} {total_nans:6,} total NaNs\\\")\\n        \\n        # Check specifically for stochastic features\\n        stoch_features_in_nans = [f for f in features_with_middle_nans.index if 'stoch' in f]\\n        print(f\\\"\\\\nStochastic features with NaNs: {len(stoch_features_in_nans)}\\\")\\n        if stoch_features_in_nans:\\n            print(\\\"  ⚠️ STOCHASTIC FIX NOT APPLIED! Should be 0.\\\")\\n            for feat in stoch_features_in_nans:\\n                print(f\\\"    {feat}: {features_with_middle_nans[feat]} NaNs\\\")\\n        else:\\n            print(\\\"  ✓ No stochastic NaNs - fix is working!\\\")\\n        \\n        # Show date range of NaN occurrences\\n        nan_dates = combined_df_clean[rows_with_middle_nans].index\\n        print(f\\\"\\\\nDate range of middle NaNs:\\\")\\n        print(f\\\"  First: {nan_dates[0]}\\\")\\n        print(f\\\"  Last: {nan_dates[-1]}\\\")\\n        \\n    else:\\n        print(\\\"\\\\n✓ No middle NaNs found!\\\")\\nelse:\\n    print(\\\"No data to analyze\\\")\",\"internalMetadata\":{\"internalId\":\"fceab976\",\"runStartTimeAdjustment\":0,\"executionId\":\"29548500-873c-40a5-9b94-960e388e8e9e\",\"runStartTime\":1764186685717,\"runEndTime\":1764186685742,\"lastRunSuccess\":true,\"executionOrder\":7,\"renderDuration\":{\"vscode.builtin-renderer\":1}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":10,\"id\":\"975b86cf\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"33be4f3f-4070-428a-a604-91d308292d75\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpJbnZlc3RpZ2F0aW5nIFJlZ2ltZSBMYWJlbCBOYU5zCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClRvdGFsIHJvd3Mgd2l0aCByZWdpbWVfbGFiZWwgTmFOOiA5NgpEYXRlIHJhbmdlOiAyMDIwLTAxLTA1IDE2OjAwOjAwIHRvIDIwMjAtMDEtMDkgMTU6MDA6MDAKCkZpcnN0IDEwIE5hTiB0aW1lc3RhbXBzOgogIDIwMjAtMDEtMDUgMTY6MDA6MDAKICAyMDIwLTAxLTA1IDE3OjAwOjAwCiAgMjAyMC0wMS0wNSAxODowMDowMAogIDIwMjAtMDEtMDUgMTk6MDA6MDAKICAyMDIwLTAxLTA1IDIwOjAwOjAwCiAgMjAyMC0wMS0wNSAyMTowMDowMAogIDIwMjAtMDEtMDUgMjI6MDA6MDAKICAyMDIwLTAxLTA1IDIzOjAwOjAwCiAgMjAyMC0wMS0wNiAwMDowMDowMAogIDIwMjAtMDEtMDYgMDE6MDA6MDAKCkNoZWNraW5nIHJhdyBkYXRhIGFyb3VuZCBOYU4gcGVyaW9kOgogIFJhdyBkYXRhIHJvd3MgaW4gdGhpcyBwZXJpb2Q6IDE0NAogIEV4cGVjdGVkIHJvd3MgKGhvdXJseSk6IDE0MwogIOKckyBObyB0aW1lIGdhcHMgZm91bmQKCkZlYXR1cmUgdmFsdWVzIGR1cmluZyBOYU4gcGVyaW9kIChmaXJzdCBOYU4gcm93KToKICB2b2xfcnNfMjRoOiBOL0EKICB2b2xfcnNfNzJoOiBOL0EKICB0cmVuZF9zdHJlbmd0aF8yNGg6IDAuMAogIGxvZ3JldF8yNGg6IDAuMAo=\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"source\":\"# Investigate why regime_label has NaNs in Jan 2020\\nprint(\\\"=\\\" * 70)\\nprint(\\\"Investigating Regime Label NaNs\\\")\\nprint(\\\"=\\\" * 70)\\n\\n# Get the rows with regime NaNs\\nregime_nans = combined_df_clean['regime_label'].isna()\\nnan_rows = combined_df_clean[regime_nans]\\n\\nprint(f\\\"\\\\nTotal rows with regime_label NaN: {regime_nans.sum()}\\\")\\nprint(f\\\"Date range: {nan_rows.index[0]} to {nan_rows.index[-1]}\\\")\\n\\n# Check if this is a continuous block\\nprint(f\\\"\\\\nFirst 10 NaN timestamps:\\\")\\nfor ts in nan_rows.index[:10]:\\n    print(f\\\"  {ts}\\\")\\n\\n# Check the raw data around this period\\nif 'raw_history' in globals():\\n    print(f\\\"\\\\nChecking raw data around NaN period:\\\")\\n    check_start = nan_rows.index[0] - pd.Timedelta(hours=24)\\n    check_end = nan_rows.index[-1] + pd.Timedelta(hours=24)\\n    \\n    raw_slice = raw_history.loc[check_start:check_end]\\n    print(f\\\"  Raw data rows in this period: {len(raw_slice)}\\\")\\n    print(f\\\"  Expected rows (hourly): {int((check_end - check_start).total_seconds() / 3600)}\\\")\\n    \\n    # Check for gaps\\n    if len(raw_slice) > 0:\\n        time_diffs = raw_slice.index.to_series().diff()\\n        gaps = time_diffs[time_diffs > pd.Timedelta(hours=1)]\\n        if len(gaps) > 0:\\n            print(f\\\"\\\\n  ⚠️ Found {len(gaps)} time gaps:\\\")\\n            for gap_time, gap_size in gaps.items():\\n                print(f\\\"    {gap_time}: {gap_size}\\\")\\n        else:\\n            print(f\\\"  ✓ No time gaps found\\\")\\n\\n# Check what features look like during this period\\nprint(f\\\"\\\\nFeature values during NaN period (first NaN row):\\\")\\nfirst_nan_row = combined_df_clean.loc[nan_rows.index[0]]\\nprint(f\\\"  vol_rs_24h: {first_nan_row.get('vol_rs_24h', 'N/A')}\\\")\\nprint(f\\\"  vol_rs_72h: {first_nan_row.get('vol_rs_72h', 'N/A')}\\\")\\nprint(f\\\"  trend_strength_24h: {first_nan_row.get('trend_strength_24h', 'N/A')}\\\")\\nprint(f\\\"  logret_24h: {first_nan_row.get('logret_24h', 'N/A')}\\\")\",\"internalMetadata\":{\"internalId\":\"a5e0731a\",\"runStartTimeAdjustment\":0,\"executionId\":\"ca74f128-bd54-421a-8294-4612ff6dc990\",\"runStartTime\":1764186766749,\"runEndTime\":1764186766756,\"lastRunSuccess\":true,\"executionOrder\":10,\"renderDuration\":{\"vscode.builtin-renderer\":0}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":11,\"id\":\"d7da7604\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"d4406837-56f1-45e0-875a-35d5b077fee7\",\"metadata\":{\"outputType\":\"stream\",\"scrollable\":true},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpDaGVja2luZyBBdmFpbGFibGUgVm9sYXRpbGl0eSBGZWF0dXJlcwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpUb3RhbCB2b2xhdGlsaXR5IGZlYXR1cmVzOiAxNDcKCkZpcnN0IDIwIHZvbCBmZWF0dXJlczoKICBhc3ltX3ZvbF92bG1faW1wYWN0CiAgY29tcHJlc3NlZF9yYW5nZV92b2wKICBjeWNsaWNhbF92b2xfY29tcHJlc3Npb24KICBkaXN0YW5jZV92b2xfZXh0cmVtZQogIGV4dHJlbWVfcmFuZ2Vfdm9sCiAga3VydG9zaXNfdm9sX2V4dHJlbWUKICBsaXFfdm9sCiAgbGlxX3ZvbF9yYXRpb19jaGFuZ2UKICBsb2dfdm9sXzEyaAogIGxvZ192b2xfMTQ0aAogIGxvZ192b2xfMjRoCiAgbG9nX3ZvbF8yODhoCiAgbG9nX3ZvbF8zaAogIGxvZ192b2xfNmgKICBsb2dfdm9sXzcyaAogIG1vbV92b2xfaW50ZXJhY3Rpb24KICBwcmV2X3NhdHVyZGF5X1Byb2dBY3RQX3hfdm9sMTJoCiAgcHJldl9zYXR1cmRheV9Qcm9nQWN0UF94X3ZvbDI0aAogIHByZXZfc2F0dXJkYXlfUHJvZ0FjdFBfeF92b2w2aAogIHByZXZfc2F0dXJkYXlfUHJvZ01heFBfeF92b2wxMmgKClJvZ2Vycy1TYXRjaGVsbCB2b2wgZmVhdHVyZXM6IDAKICDimqDvuI8gTk8gUm9nZXJzLVNhdGNoZWxsIHZvbGF0aWxpdHkgZmVhdHVyZXMgZm91bmQhCiAgVGhpcyBtZWFucyB0aGUgVm9sYXRpbGl0eVJlZ2ltZUVuZ2luZWVyIGNhbm5vdCBjb21wdXRlIHZvbGF0aWxpdHkuCgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CldoYXQgVm9sYXRpbGl0eVJlZ2ltZUVuZ2luZWVyIG5lZWRzOgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClRoZSByZWdpbWUgZW5naW5lZXIgY29tcHV0ZXMgUm9nZXJzLVNhdGNoZWxsIHZvbCBpbnRlcm5hbGx5IGZyb20gT0hMQwpJdCBkb2VzIE5PVCB1c2UgcHJlLWNvbXB1dGVkIHZvbF9ycyBmZWF0dXJlcyBmcm9tIGZlYXR1cmVFbmdpbmVlciEKCkJ1dCBpdCdzIHBhc3NlZCB0aGUgZmVhdHVyZXMgRGF0YUZyYW1lLCBhbmQgaXQgc2hvdWxkIGhhdmUgT0hMQyBjb2x1bW5zLi4uCgpPSExDIGNvbHVtbnMgaW4gZmVhdHVyZXM6IFtdCiAg4pqg77iPIE1JU1NJTkcgT0hMQyEgUmVnaW1lIGVuZ2luZWVyIG5lZWRzIGFsbCA0IE9ITEMgY29sdW1ucwogIE1pc3Npbmc6IFsnb3BlbicsICdoaWdoJywgJ2xvdycsICdjbG9zZSddCg==\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"source\":\"# Check what volatility features actually exist\\nprint(\\\"=\\\" * 70)\\nprint(\\\"Checking Available Volatility Features\\\")\\nprint(\\\"=\\\" * 70)\\n\\n# Get all vol features\\nvol_features = [col for col in features.columns if 'vol' in col.lower()]\\nprint(f\\\"\\\\nTotal volatility features: {len(vol_features)}\\\")\\nprint(f\\\"\\\\nFirst 20 vol features:\\\")\\nfor feat in sorted(vol_features)[:20]:\\n    print(f\\\"  {feat}\\\")\\n\\n# Specifically look for Rogers-Satchell vol\\nrs_vol_features = [col for col in features.columns if 'vol_rs' in col]\\nprint(f\\\"\\\\nRogers-Satchell vol features: {len(rs_vol_features)}\\\")\\nif rs_vol_features:\\n    for feat in rs_vol_features:\\n        print(f\\\"  {feat}\\\")\\nelse:\\n    print(\\\"  ⚠️ NO Rogers-Satchell volatility features found!\\\")\\n    print(\\\"  This means the VolatilityRegimeEngineer cannot compute volatility.\\\")\\n    \\n# Check what the regime engineer expects\\nprint(f\\\"\\\\n\\\" + \\\"=\\\" * 70)\\nprint(\\\"What VolatilityRegimeEngineer needs:\\\")\\nprint(\\\"=\\\" * 70)\\nprint(\\\"The regime engineer computes Rogers-Satchell vol internally from OHLC\\\")\\nprint(\\\"It does NOT use pre-computed vol_rs features from featureEngineer!\\\")\\nprint(\\\"\\\\nBut it's passed the features DataFrame, and it should have OHLC columns...\\\")\\n\\n# Check if features has OHLC\\nohlc_cols = ['open', 'high', 'low', 'close']\\nhas_ohlc = [col for col in ohlc_cols if col in features.columns]\\nprint(f\\\"\\\\nOHLC columns in features: {has_ohlc}\\\")\\nif len(has_ohlc) < 4:\\n    print(f\\\"  ⚠️ MISSING OHLC! Regime engineer needs all 4 OHLC columns\\\")\\n    print(f\\\"  Missing: {[c for c in ohlc_cols if c not in features.columns]}\\\")\",\"internalMetadata\":{\"internalId\":\"eba3e393\",\"runStartTimeAdjustment\":0,\"executionId\":\"d4fccd2c-6cfa-49ea-8edc-87ca880eb6c6\",\"runStartTime\":1764186813314,\"runEndTime\":1764186813315,\"lastRunSuccess\":true,\"executionOrder\":11,\"renderDuration\":{\"vscode.builtin-renderer\":2}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":8,\"id\":\"8948a1bd\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"02e8ec0b-3b6f-441d-90a6-675f52319ac7\",\"metadata\":{\"outputType\":\"stream\"},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"U3BsaXQgc2l6ZXM6CiAgVHJhaW46IDQyLDk0MCByb3dzICg4MC4wJSkKICBWYWw6ICAgNSwzNjcgcm93cyAoMTAuMCUpCiAgVGVzdDogIDUsMzY4IHJvd3MgKDEwLjAlKQoKWCBzaGFwZXMgLT4gdHJhaW4gKDQyOTQwLCA0NTApLCB2YWwgKDUzNjcsIDQ1MCksIHRlc3QgKDUzNjgsIDQ1MCkKeSBzaGFwZXMgLT4gdHJhaW4gKDQyOTQwLCA2KSwgdmFsICg1MzY3LCA2KSwgdGVzdCAoNTM2OCwgNikKCuKaoCBOYU5zIGZvdW5kOgogIFRyYWluOiAyMyBOYU5zCg==\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]}],\"mime\":\"text/plain\",\"source\":\"# Split into train/val/test (80/10/10)\\nn_samples = len(combined_df_clean)\\ntrain_end = int(n_samples * 0.8)\\nval_end = train_end + int(n_samples * 0.1)\\n\\n# Get feature and target columns\\nfeature_cols = features.columns.intersection(combined_df_clean.columns)\\ntarget_cols = targets.columns.intersection(combined_df_clean.columns)\\n\\nX_train = combined_df_clean[feature_cols].iloc[:train_end]\\nX_val = combined_df_clean[feature_cols].iloc[train_end:val_end]\\nX_test = combined_df_clean[feature_cols].iloc[val_end:]\\n\\ny_train = combined_df_clean[target_cols].iloc[:train_end]\\ny_val = combined_df_clean[target_cols].iloc[train_end:val_end]\\ny_test = combined_df_clean[target_cols].iloc[val_end:]\\n\\nprint(f\\\"Split sizes:\\\")\\nprint(f\\\"  Train: {len(X_train):,} rows ({len(X_train)/n_samples*100:.1f}%)\\\")\\nprint(f\\\"  Val:   {len(X_val):,} rows ({len(X_val)/n_samples*100:.1f}%)\\\")\\nprint(f\\\"  Test:  {len(X_test):,} rows ({len(X_test)/n_samples*100:.1f}%)\\\")\\n\\nprint(f\\\"\\\\nX shapes -> train {X_train.shape}, val {X_val.shape}, test {X_test.shape}\\\")\\nprint(f\\\"y shapes -> train {y_train.shape}, val {y_val.shape}, test {y_test.shape}\\\")\\n\\n# Final NaN check on all splits\\ntrain_nans = X_train.isna().sum().sum()\\nval_nans = X_val.isna().sum().sum()\\ntest_nans = X_test.isna().sum().sum()\\n\\nif train_nans + val_nans + test_nans == 0:\\n    print(\\\"\\\\n✓ No NaNs in any split - ready for training!\\\")\\nelse:\\n    print(f\\\"\\\\n⚠ NaNs found:\\\")\\n    if train_nans > 0:\\n        print(f\\\"  Train: {train_nans} NaNs\\\")\\n    if val_nans > 0:\\n        print(f\\\"  Val: {val_nans} NaNs\\\")\\n    if test_nans > 0:\\n        print(f\\\"  Test: {test_nans} NaNs\\\")\",\"internalMetadata\":{\"internalId\":\"6017794d\",\"runStartTimeAdjustment\":0,\"executionId\":\"d6a62885-4d1d-40be-b86b-517d649e6240\",\"runStartTime\":1764186701691,\"runEndTime\":1764186701778,\"lastRunSuccess\":true,\"executionOrder\":8,\"renderDuration\":{\"vscode.builtin-renderer\":0}}}],\"metadata\":{\"metadata\":{\"kernelspec\":{\"display_name\":\".venv\",\"language\":\"python\",\"name\":\"python3\"},\"language_info\":{\"codemirror_mode\":{\"name\":\"ipython\",\"version\":3},\"file_extension\":\".py\",\"mimetype\":\"text/x-python\",\"name\":\"python\",\"nbconvert_exporter\":\"python\",\"pygments_lexer\":\"ipython3\",\"version\":\"3.13.7\"}},\"nbformat\":4,\"nbformat_minor\":5}}"]