["{\"transientOutputs\":false,\"transientCellMetadata\":{\"breakpointMargin\":true,\"id\":false,\"metadata\":false,\"attachments\":false},\"transientDocumentMetadata\":{\"cells\":true,\"indentAmount\":true},\"cellContentMetadata\":{\"attachments\":true}}","{\"cells\":[{\"cellKind\":1,\"language\":\"markdown\",\"metadata\":{\"metadata\":{},\"id\":\"4d8fd73a\"},\"outputs\":[],\"source\":\"# Feature & Target Pipeline\\nQuick tests and evaluation on new targets/features/models\",\"internalMetadata\":{\"internalId\":\"b6cc7e85\"}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":3,\"id\":\"64b95c13\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"ef7f068c-24cb-4499-993a-effddfeec1a1\",\"metadata\":{\"outputType\":\"stream\",\"scrollable\":true},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"SW1wb3J0cyBhbmQgY29uZmlndXJhdGlvbiByZWFkeQo9PT0gTG9hZGluZyAuaGlzdF9kYl8xaC5jc3YgPT09CgpJbml0aWFsIHJvd3M6IDUzLDk2MwoKPT09IEZPVU5EIElTU1VFUyAocHJpb3IgdG8gYXV0b21hdGVkIGZpeGVzKSA9PT0KCvCflLQgVEVNUE9SQUw6IE1pc3NpbmcgaG91cnM6IDEgY2FzZXMKICBNaXNzaW5nIHRpbWVzdGFtcHMgc2FtcGxlOgogICAgMjAyNS0xMS0wNCAxMzowMDowMAoK8J+UtCBEQVRBIElOVEVHUklUWTogSWRlbnRpY2FsIGNvbnNlY3V0aXZlIE9ITEMgcm93czogMTc0IGNhc2VzCiAgU2FtcGxlIGNhc2VzOgogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogICAgeydvJzogJzcxMTAuMTAnLCAnaCc6ICc3MTEwLjEwJywgJ2wnOiAnNzExMC4xMCcsICdjJzogJzcxMTAuMTAnLCAndm9sQ2N5JzogJzAuMDAnfQogIEFmZmVjdGVkIGRhdGVzIChzYW1wbGUpOiAyMDIwLTAxLTAyLCAyMDIwLTAxLTAzLCAyMDIwLTAxLTA0LCAyMDIwLTAxLTA1LCAyMDIwLTAxLTA2Cgo9PT0gQVBQTFlJTkcgQVVUT01BVEVEIEZJWEVTID09PQpBQ1RJT046IFJlc2FtcGxlZC9SZWluZGV4ZWQgdG8gNTM5NjQgaG91cmx5IGludGVydmFscyAod2FzIDUzOTYzKS4KQUNUSU9OOiBGb3J3YXJkLWZpbGxlZCBOYU5zIGFmdGVyIHJlc2FtcGxpbmcuICg1IE5hTnMgcG90ZW50aWFsbHkgZmlsbGVkIGJ5IGZmaWxsKS4KCj09PSBGSU5BTCBTVEFUVVMgKGFmdGVyIGF1dG9tYXRlZCBmaXhlcykgPT09CkRhdGFGcmFtZSBzaGFwZSBwb3N0LWZpeGVzOiAoNTM5NjQsIDUpIChPcmlnaW5hbDogKDUzOTYzLCA2KSkKRGF0ZSByYW5nZTogMjAxOS0xMC0wMSAwMDowMDowMCB0byAyMDI1LTExLTI2IDExOjAwOjAwCk5vIG51bGwgdmFsdWVzIHJlbWFpbmluZyBhZnRlciBmaXhlcy4KVG90YWwgbnVsbCB2YWx1ZXMgcmVtYWluaW5nIGFmdGVyIGZpeGVzOiAwCkhlYXZ5IGNhY2hlIHJlYWR5OiBoZWF2eV9mZWF0dXJlc192MS5wa2wgKHRvdGFsIDEpIGluIGNhY2hlL2hlYXZ5X2ZlYXR1cmVzCkxvYWRlZCBoZWF2eSBjYWNoZSBwYXlsb2FkIGZyb20gZGlzazsgc2tpcHBpbmcgcmVidWlsZC4KTWFudWFsIGZlYXR1cmVzIHNoYXBlIGZyb20gY2FjaGU6ICg1Mzk2NCwgNDUwKQpNYW51YWwgZmVhdHVyZXMgc2hhcGUgZnJvbSBjYWNoZTogKDUzOTY0LCA0NTApCg==\"},\"mime\":\"application/vnd.code.notebook.stdout\"}]},{\"outputId\":\"c0fd2b68-b78e-48f4-8607-a0ba73d9991e\",\"metadata\":{\"outputType\":\"error\",\"originalError\":{\"output_type\":\"error\",\"ename\":\"KeyboardInterrupt\",\"evalue\":\"\",\"traceback\":[\"\\u001b[31m---------------------------------------------------------------------------\\u001b[39m\",\"\\u001b[31mKeyboardInterrupt\\u001b[39m                         Traceback (most recent call last)\",\"\\u001b[36mCell\\u001b[39m\\u001b[36m \\u001b[39m\\u001b[32mIn[3]\\u001b[39m\\u001b[32m, line 94\\u001b[39m\\n\\u001b[32m     92\\u001b[39m \\u001b[38;5;66;03m# Run Fit/Transform\\u001b[39;00m\\n\\u001b[32m     93\\u001b[39m regime_engineer.fit(df_train)\\n\\u001b[32m---> \\u001b[39m\\u001b[32m94\\u001b[39m targets = \\u001b[43mregime_engineer\\u001b[49m\\u001b[43m.\\u001b[49m\\u001b[43mtransform\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mdf_train\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m     96\\u001b[39m \\u001b[38;5;66;03m# Check the distribution\\u001b[39;00m\\n\\u001b[32m     97\\u001b[39m dist = regime_engineer.get_regime_distribution(df_train)\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/sklearn/utils/_set_output.py:316\\u001b[39m, in \\u001b[36m_wrap_method_output.<locals>.wrapped\\u001b[39m\\u001b[34m(self, X, *args, **kwargs)\\u001b[39m\\n\\u001b[32m    314\\u001b[39m \\u001b[38;5;129m@wraps\\u001b[39m(f)\\n\\u001b[32m    315\\u001b[39m \\u001b[38;5;28;01mdef\\u001b[39;00m\\u001b[38;5;250m \\u001b[39m\\u001b[34mwrapped\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, X, *args, **kwargs):\\n\\u001b[32m--> \\u001b[39m\\u001b[32m316\\u001b[39m     data_to_wrap = \\u001b[43mf\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mX\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43m*\\u001b[49m\\u001b[43margs\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43m*\\u001b[49m\\u001b[43m*\\u001b[49m\\u001b[43mkwargs\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m    317\\u001b[39m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28misinstance\\u001b[39m(data_to_wrap, \\u001b[38;5;28mtuple\\u001b[39m):\\n\\u001b[32m    318\\u001b[39m         \\u001b[38;5;66;03m# only wrap the first output for cross decomposition\\u001b[39;00m\\n\\u001b[32m    319\\u001b[39m         return_tuple = (\\n\\u001b[32m    320\\u001b[39m             _wrap_data_with_container(method, data_to_wrap[\\u001b[32m0\\u001b[39m], X, \\u001b[38;5;28mself\\u001b[39m),\\n\\u001b[32m    321\\u001b[39m             *data_to_wrap[\\u001b[32m1\\u001b[39m:],\\n\\u001b[32m    322\\u001b[39m         )\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m/shared/eastSync/pyEast/pro_version/targetEngineer.py:343\\u001b[39m, in \\u001b[36mVolatilityRegimeEngineer.transform\\u001b[39m\\u001b[34m(self, X)\\u001b[39m\\n\\u001b[32m    341\\u001b[39m check_is_fitted(\\u001b[38;5;28mself\\u001b[39m, \\u001b[33m'\\u001b[39m\\u001b[33m_seasonal_vol_lookup\\u001b[39m\\u001b[33m'\\u001b[39m)\\n\\u001b[32m    342\\u001b[39m box_df = \\u001b[38;5;28mself\\u001b[39m._calculate_lookback_box(X)\\n\\u001b[32m--> \\u001b[39m\\u001b[32m343\\u001b[39m results = \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43m_assign_regime_labels\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mX\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mbox_df\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m    345\\u001b[39m output = results.copy()\\n\\u001b[32m    346\\u001b[39m output[\\u001b[33m'\\u001b[39m\\u001b[33mbox_std_deseasonalized\\u001b[39m\\u001b[33m'\\u001b[39m] = box_df[\\u001b[33m'\\u001b[39m\\u001b[33mbox_std\\u001b[39m\\u001b[33m'\\u001b[39m]\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m/shared/eastSync/pyEast/pro_version/targetEngineer.py:301\\u001b[39m, in \\u001b[36mVolatilityRegimeEngineer._assign_regime_labels\\u001b[39m\\u001b[34m(self, X, box_df)\\u001b[39m\\n\\u001b[32m    299\\u001b[39m sub_indices = fwd_indices[i : i + \\u001b[38;5;28mself\\u001b[39m.jump_speed_window]\\n\\u001b[32m    300\\u001b[39m s_high = high.loc[sub_indices].max()\\n\\u001b[32m--> \\u001b[39m\\u001b[32m301\\u001b[39m s_low = \\u001b[43mlow\\u001b[49m\\u001b[43m.\\u001b[49m\\u001b[43mloc\\u001b[49m\\u001b[43m[\\u001b[49m\\u001b[43msub_indices\\u001b[49m\\u001b[43m]\\u001b[49m.min()\\n\\u001b[32m    302\\u001b[39m s_ret = \\u001b[38;5;28mmax\\u001b[39m(\\u001b[38;5;28mabs\\u001b[39m(np.log(s_high/ref_price)), \\u001b[38;5;28mabs\\u001b[39m(np.log(s_low/ref_price)))\\n\\u001b[32m    303\\u001b[39m current_z = s_ret / (box_std * sqrt_jump)\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexing.py:1192\\u001b[39m, in \\u001b[36m_LocationIndexer.__getitem__\\u001b[39m\\u001b[34m(self, key)\\u001b[39m\\n\\u001b[32m   1190\\u001b[39m maybe_callable = com.apply_if_callable(key, \\u001b[38;5;28mself\\u001b[39m.obj)\\n\\u001b[32m   1191\\u001b[39m maybe_callable = \\u001b[38;5;28mself\\u001b[39m._check_deprecated_callable_usage(key, maybe_callable)\\n\\u001b[32m-> \\u001b[39m\\u001b[32m1192\\u001b[39m \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43m_getitem_axis\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmaybe_callable\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43maxis\\u001b[49m\\u001b[43m=\\u001b[49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexing.py:1421\\u001b[39m, in \\u001b[36m_LocIndexer._getitem_axis\\u001b[39m\\u001b[34m(self, key, axis)\\u001b[39m\\n\\u001b[32m   1418\\u001b[39m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mhasattr\\u001b[39m(key, \\u001b[33m\\\"\\u001b[39m\\u001b[33mndim\\u001b[39m\\u001b[33m\\\"\\u001b[39m) \\u001b[38;5;129;01mand\\u001b[39;00m key.ndim > \\u001b[32m1\\u001b[39m:\\n\\u001b[32m   1419\\u001b[39m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mValueError\\u001b[39;00m(\\u001b[33m\\\"\\u001b[39m\\u001b[33mCannot index with multidimensional key\\u001b[39m\\u001b[33m\\\"\\u001b[39m)\\n\\u001b[32m-> \\u001b[39m\\u001b[32m1421\\u001b[39m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43m_getitem_iterable\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mkey\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43maxis\\u001b[49m\\u001b[43m=\\u001b[49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m   1423\\u001b[39m \\u001b[38;5;66;03m# nested tuple slicing\\u001b[39;00m\\n\\u001b[32m   1424\\u001b[39m \\u001b[38;5;28;01mif\\u001b[39;00m is_nested_tuple(key, labels):\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexing.py:1361\\u001b[39m, in \\u001b[36m_LocIndexer._getitem_iterable\\u001b[39m\\u001b[34m(self, key, axis)\\u001b[39m\\n\\u001b[32m   1358\\u001b[39m \\u001b[38;5;28mself\\u001b[39m._validate_key(key, axis)\\n\\u001b[32m   1360\\u001b[39m \\u001b[38;5;66;03m# A collection of keys\\u001b[39;00m\\n\\u001b[32m-> \\u001b[39m\\u001b[32m1361\\u001b[39m keyarr, indexer = \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43m_get_listlike_indexer\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mkey\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m   1362\\u001b[39m \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m.obj._reindex_with_indexers(\\n\\u001b[32m   1363\\u001b[39m     {axis: [keyarr, indexer]}, copy=\\u001b[38;5;28;01mTrue\\u001b[39;00m, allow_dups=\\u001b[38;5;28;01mTrue\\u001b[39;00m\\n\\u001b[32m   1364\\u001b[39m )\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexing.py:1559\\u001b[39m, in \\u001b[36m_LocIndexer._get_listlike_indexer\\u001b[39m\\u001b[34m(self, key, axis)\\u001b[39m\\n\\u001b[32m   1556\\u001b[39m ax = \\u001b[38;5;28mself\\u001b[39m.obj._get_axis(axis)\\n\\u001b[32m   1557\\u001b[39m axis_name = \\u001b[38;5;28mself\\u001b[39m.obj._get_axis_name(axis)\\n\\u001b[32m-> \\u001b[39m\\u001b[32m1559\\u001b[39m keyarr, indexer = \\u001b[43max\\u001b[49m\\u001b[43m.\\u001b[49m\\u001b[43m_get_indexer_strict\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mkey\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43maxis_name\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m   1561\\u001b[39m \\u001b[38;5;28;01mreturn\\u001b[39;00m keyarr, indexer\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:6214\\u001b[39m, in \\u001b[36mIndex._get_indexer_strict\\u001b[39m\\u001b[34m(self, key, axis_name)\\u001b[39m\\n\\u001b[32m   6210\\u001b[39m     keyarr, indexer, new_indexer = \\u001b[38;5;28mself\\u001b[39m._reindex_non_unique(keyarr)\\n\\u001b[32m   6212\\u001b[39m \\u001b[38;5;28mself\\u001b[39m._raise_if_missing(keyarr, indexer, axis_name)\\n\\u001b[32m-> \\u001b[39m\\u001b[32m6214\\u001b[39m keyarr = \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43mtake\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mindexer\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m   6215\\u001b[39m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28misinstance\\u001b[39m(key, Index):\\n\\u001b[32m   6216\\u001b[39m     \\u001b[38;5;66;03m# GH 42790 - Preserve name from an Index\\u001b[39;00m\\n\\u001b[32m   6217\\u001b[39m     keyarr.name = key.name\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexes/datetimelike.py:841\\u001b[39m, in \\u001b[36mDatetimeTimedeltaMixin.take\\u001b[39m\\u001b[34m(self, indices, axis, allow_fill, fill_value, **kwargs)\\u001b[39m\\n\\u001b[32m    839\\u001b[39m maybe_slice = lib.maybe_indices_to_slice(indices, \\u001b[38;5;28mlen\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m))\\n\\u001b[32m    840\\u001b[39m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28misinstance\\u001b[39m(maybe_slice, \\u001b[38;5;28mslice\\u001b[39m):\\n\\u001b[32m--> \\u001b[39m\\u001b[32m841\\u001b[39m     freq = \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m.\\u001b[49m\\u001b[43m_data\\u001b[49m\\u001b[43m.\\u001b[49m\\u001b[43m_get_getitem_freq\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmaybe_slice\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[32m    842\\u001b[39m     result._data._freq = freq\\n\\u001b[32m    843\\u001b[39m \\u001b[38;5;28;01mreturn\\u001b[39;00m result\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py:417\\u001b[39m, in \\u001b[36mDatetimeLikeArrayMixin._get_getitem_freq\\u001b[39m\\u001b[34m(self, key)\\u001b[39m\\n\\u001b[32m    415\\u001b[39m     freq = \\u001b[38;5;28;01mNone\\u001b[39;00m\\n\\u001b[32m    416\\u001b[39m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[32m--> \\u001b[39m\\u001b[32m417\\u001b[39m     key = \\u001b[43mcheck_array_indexer\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mkey\\u001b[49m\\u001b[43m)\\u001b[49m  \\u001b[38;5;66;03m# maybe ndarray[bool] -> slice\\u001b[39;00m\\n\\u001b[32m    418\\u001b[39m     freq = \\u001b[38;5;28;01mNone\\u001b[39;00m\\n\\u001b[32m    419\\u001b[39m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28misinstance\\u001b[39m(key, \\u001b[38;5;28mslice\\u001b[39m):\\n\",\"\\u001b[36mFile \\u001b[39m\\u001b[32m~/shared/eastSync/pyEast/pro_version/.venv/lib/python3.13/site-packages/pandas/core/indexers/utils.py:517\\u001b[39m, in \\u001b[36mcheck_array_indexer\\u001b[39m\\u001b[34m(array, indexer)\\u001b[39m\\n\\u001b[32m    511\\u001b[39m \\u001b[38;5;28;01mfrom\\u001b[39;00m\\u001b[38;5;250m \\u001b[39m\\u001b[34;01mpandas\\u001b[39;00m\\u001b[34;01m.\\u001b[39;00m\\u001b[34;01mcore\\u001b[39;00m\\u001b[34;01m.\\u001b[39;00m\\u001b[34;01mconstruction\\u001b[39;00m\\u001b[38;5;250m \\u001b[39m\\u001b[38;5;28;01mimport\\u001b[39;00m array \\u001b[38;5;28;01mas\\u001b[39;00m pd_array\\n\\u001b[32m    513\\u001b[39m \\u001b[38;5;66;03m# whatever is not an array-like is returned as-is (possible valid array\\u001b[39;00m\\n\\u001b[32m    514\\u001b[39m \\u001b[38;5;66;03m# indexers that are not array-like: integer, slice, Ellipsis, None)\\u001b[39;00m\\n\\u001b[32m    515\\u001b[39m \\u001b[38;5;66;03m# In this context, tuples are not considered as array-like, as they have\\u001b[39;00m\\n\\u001b[32m    516\\u001b[39m \\u001b[38;5;66;03m# a specific meaning in indexing (multi-dimensional indexing)\\u001b[39;00m\\n\\u001b[32m--> \\u001b[39m\\u001b[32m517\\u001b[39m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[43mis_list_like\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mindexer\\u001b[49m\\u001b[43m)\\u001b[49m:\\n\\u001b[32m    518\\u001b[39m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28misinstance\\u001b[39m(indexer, \\u001b[38;5;28mtuple\\u001b[39m):\\n\\u001b[32m    519\\u001b[39m         \\u001b[38;5;28;01mreturn\\u001b[39;00m indexer\\n\",\"\\u001b[31mKeyboardInterrupt\\u001b[39m: \"]}},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"ewoJIm5hbWUiOiAiS2V5Ym9hcmRJbnRlcnJ1cHQiLAoJIm1lc3NhZ2UiOiAiIiwKCSJzdGFjayI6ICJcdTAwMWJbMzFtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHUwMDFiWzM5bVxuXHUwMDFiWzMxbUtleWJvYXJkSW50ZXJydXB0XHUwMDFiWzM5bSAgICAgICAgICAgICAgICAgICAgICAgICBUcmFjZWJhY2sgKG1vc3QgcmVjZW50IGNhbGwgbGFzdClcblx1MDAxYlszNm1DZWxsXHUwMDFiWzM5bVx1MDAxYlszNm0gXHUwMDFiWzM5bVx1MDAxYlszMm1JblszXVx1MDAxYlszOW1cdTAwMWJbMzJtLCBsaW5lIDk0XHUwMDFiWzM5bVxuXHUwMDFiWzMybSAgICAgOTJcdTAwMWJbMzltIFx1MDAxYlszODs1OzY2OzAzbSMgUnVuIEZpdC9UcmFuc2Zvcm1cdTAwMWJbMzk7MDBtXG5cdTAwMWJbMzJtICAgICA5M1x1MDAxYlszOW0gcmVnaW1lX2VuZ2luZWVyLmZpdChkZl90cmFpbilcblx1MDAxYlszMm0tLS0+IFx1MDAxYlszOW1cdTAwMWJbMzJtOTRcdTAwMWJbMzltIHRhcmdldHMgPSBcdTAwMWJbNDNtcmVnaW1lX2VuZ2luZWVyXHUwMDFiWzQ5bVx1MDAxYls0M20uXHUwMDFiWzQ5bVx1MDAxYls0M210cmFuc2Zvcm1cdTAwMWJbNDltXHUwMDFiWzQzbShcdTAwMWJbNDltXHUwMDFiWzQzbWRmX3RyYWluXHUwMDFiWzQ5bVx1MDAxYls0M20pXHUwMDFiWzQ5bVxuXHUwMDFiWzMybSAgICAgOTZcdTAwMWJbMzltIFx1MDAxYlszODs1OzY2OzAzbSMgQ2hlY2sgdGhlIGRpc3RyaWJ1dGlvblx1MDAxYlszOTswMG1cblx1MDAxYlszMm0gICAgIDk3XHUwMDFiWzM5bSBkaXN0ID0gcmVnaW1lX2VuZ2luZWVyLmdldF9yZWdpbWVfZGlzdHJpYnV0aW9uKGRmX3RyYWluKVxuXG5cdTAwMWJbMzZtRmlsZSBcdTAwMWJbMzltXHUwMDFiWzMybX4vc2hhcmVkL2Vhc3RTeW5jL3B5RWFzdC9wcm9fdmVyc2lvbi8udmVudi9saWIvcHl0aG9uMy4xMy9zaXRlLXBhY2thZ2VzL3NrbGVhcm4vdXRpbHMvX3NldF9vdXRwdXQucHk6MzE2XHUwMDFiWzM5bSwgaW4gXHUwMDFiWzM2bV93cmFwX21ldGhvZF9vdXRwdXQuPGxvY2Fscz4ud3JhcHBlZFx1MDAxYlszOW1cdTAwMWJbMzRtKHNlbGYsIFgsICphcmdzLCAqKmt3YXJncylcdTAwMWJbMzltXG5cdTAwMWJbMzJtICAgIDMxNFx1MDAxYlszOW0gXHUwMDFiWzM4OzU7MTI5bUB3cmFwc1x1MDAxYlszOW0oZilcblx1MDAxYlszMm0gICAgMzE1XHUwMDFiWzM5bSBcdTAwMWJbMzg7NTsyODswMW1kZWZcdTAwMWJbMzk7MDBtXHUwMDFiWzM4OzU7MjUwbSBcdTAwMWJbMzltXHUwMDFiWzM0bXdyYXBwZWRcdTAwMWJbMzltKFx1MDAxYlszODs1OzI4bXNlbGZcdTAwMWJbMzltLCBYLCAqYXJncywgKiprd2FyZ3MpOlxuXHUwMDFiWzMybS0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTMxNlx1MDAxYlszOW0gICAgIGRhdGFfdG9fd3JhcCA9IFx1MDAxYls0M21mXHUwMDFiWzQ5bVx1MDAxYls0M20oXHUwMDFiWzQ5bVx1MDAxYlszODs1OzI4OzQzbXNlbGZcdTAwMWJbMzk7NDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbVhcdTAwMWJbNDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbSpcdTAwMWJbNDltXHUwMDFiWzQzbWFyZ3NcdTAwMWJbNDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbSpcdTAwMWJbNDltXHUwMDFiWzQzbSpcdTAwMWJbNDltXHUwMDFiWzQzbWt3YXJnc1x1MDAxYls0OW1cdTAwMWJbNDNtKVx1MDAxYls0OW1cblx1MDAxYlszMm0gICAgMzE3XHUwMDFiWzM5bSAgICAgXHUwMDFiWzM4OzU7Mjg7MDFtaWZcdTAwMWJbMzk7MDBtIFx1MDAxYlszODs1OzI4bWlzaW5zdGFuY2VcdTAwMWJbMzltKGRhdGFfdG9fd3JhcCwgXHUwMDFiWzM4OzU7MjhtdHVwbGVcdTAwMWJbMzltKTpcblx1MDAxYlszMm0gICAgMzE4XHUwMDFiWzM5bSAgICAgICAgIFx1MDAxYlszODs1OzY2OzAzbSMgb25seSB3cmFwIHRoZSBmaXJzdCBvdXRwdXQgZm9yIGNyb3NzIGRlY29tcG9zaXRpb25cdTAwMWJbMzk7MDBtXG5cdTAwMWJbMzJtICAgIDMxOVx1MDAxYlszOW0gICAgICAgICByZXR1cm5fdHVwbGUgPSAoXG5cdTAwMWJbMzJtICAgIDMyMFx1MDAxYlszOW0gICAgICAgICAgICAgX3dyYXBfZGF0YV93aXRoX2NvbnRhaW5lcihtZXRob2QsIGRhdGFfdG9fd3JhcFtcdTAwMWJbMzJtMFx1MDAxYlszOW1dLCBYLCBcdTAwMWJbMzg7NTsyOG1zZWxmXHUwMDFiWzM5bSksXG5cdTAwMWJbMzJtICAgIDMyMVx1MDAxYlszOW0gICAgICAgICAgICAgKmRhdGFfdG9fd3JhcFtcdTAwMWJbMzJtMVx1MDAxYlszOW06XSxcblx1MDAxYlszMm0gICAgMzIyXHUwMDFiWzM5bSAgICAgICAgIClcblxuXHUwMDFiWzM2bUZpbGUgXHUwMDFiWzM5bVx1MDAxYlszMm0vc2hhcmVkL2Vhc3RTeW5jL3B5RWFzdC9wcm9fdmVyc2lvbi90YXJnZXRFbmdpbmVlci5weTozNDNcdTAwMWJbMzltLCBpbiBcdTAwMWJbMzZtVm9sYXRpbGl0eVJlZ2ltZUVuZ2luZWVyLnRyYW5zZm9ybVx1MDAxYlszOW1cdTAwMWJbMzRtKHNlbGYsIFgpXHUwMDFiWzM5bVxuXHUwMDFiWzMybSAgICAzNDFcdTAwMWJbMzltIGNoZWNrX2lzX2ZpdHRlZChcdTAwMWJbMzg7NTsyOG1zZWxmXHUwMDFiWzM5bSwgXHUwMDFiWzMzbSdcdTAwMWJbMzltXHUwMDFiWzMzbV9zZWFzb25hbF92b2xfbG9va3VwXHUwMDFiWzM5bVx1MDAxYlszM20nXHUwMDFiWzM5bSlcblx1MDAxYlszMm0gICAgMzQyXHUwMDFiWzM5bSBib3hfZGYgPSBcdTAwMWJbMzg7NTsyOG1zZWxmXHUwMDFiWzM5bS5fY2FsY3VsYXRlX2xvb2tiYWNrX2JveChYKVxuXHUwMDFiWzMybS0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTM0M1x1MDAxYlszOW0gcmVzdWx0cyA9IFx1MDAxYlszODs1OzI4OzQzbXNlbGZcdTAwMWJbMzk7NDltXHUwMDFiWzQzbS5cdTAwMWJbNDltXHUwMDFiWzQzbV9hc3NpZ25fcmVnaW1lX2xhYmVsc1x1MDAxYls0OW1cdTAwMWJbNDNtKFx1MDAxYls0OW1cdTAwMWJbNDNtWFx1MDAxYls0OW1cdTAwMWJbNDNtLFx1MDAxYls0OW1cdTAwMWJbNDNtIFx1MDAxYls0OW1cdTAwMWJbNDNtYm94X2RmXHUwMDFiWzQ5bVx1MDAxYls0M20pXHUwMDFiWzQ5bVxuXHUwMDFiWzMybSAgICAzNDVcdTAwMWJbMzltIG91dHB1dCA9IHJlc3VsdHMuY29weSgpXG5cdTAwMWJbMzJtICAgIDM0Nlx1MDAxYlszOW0gb3V0cHV0W1x1MDAxYlszM20nXHUwMDFiWzM5bVx1MDAxYlszM21ib3hfc3RkX2Rlc2Vhc29uYWxpemVkXHUwMDFiWzM5bVx1MDAxYlszM20nXHUwMDFiWzM5bV0gPSBib3hfZGZbXHUwMDFiWzMzbSdcdTAwMWJbMzltXHUwMDFiWzMzbWJveF9zdGRcdTAwMWJbMzltXHUwMDFiWzMzbSdcdTAwMWJbMzltXVxuXG5cdTAwMWJbMzZtRmlsZSBcdTAwMWJbMzltXHUwMDFiWzMybS9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uL3RhcmdldEVuZ2luZWVyLnB5OjMwMVx1MDAxYlszOW0sIGluIFx1MDAxYlszNm1Wb2xhdGlsaXR5UmVnaW1lRW5naW5lZXIuX2Fzc2lnbl9yZWdpbWVfbGFiZWxzXHUwMDFiWzM5bVx1MDAxYlszNG0oc2VsZiwgWCwgYm94X2RmKVx1MDAxYlszOW1cblx1MDAxYlszMm0gICAgMjk5XHUwMDFiWzM5bSBzdWJfaW5kaWNlcyA9IGZ3ZF9pbmRpY2VzW2kgOiBpICsgXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0uanVtcF9zcGVlZF93aW5kb3ddXG5cdTAwMWJbMzJtICAgIDMwMFx1MDAxYlszOW0gc19oaWdoID0gaGlnaC5sb2Nbc3ViX2luZGljZXNdLm1heCgpXG5cdTAwMWJbMzJtLS0+IFx1MDAxYlszOW1cdTAwMWJbMzJtMzAxXHUwMDFiWzM5bSBzX2xvdyA9IFx1MDAxYls0M21sb3dcdTAwMWJbNDltXHUwMDFiWzQzbS5cdTAwMWJbNDltXHUwMDFiWzQzbWxvY1x1MDAxYls0OW1cdTAwMWJbNDNtW1x1MDAxYls0OW1cdTAwMWJbNDNtc3ViX2luZGljZXNcdTAwMWJbNDltXHUwMDFiWzQzbV1cdTAwMWJbNDltLm1pbigpXG5cdTAwMWJbMzJtICAgIDMwMlx1MDAxYlszOW0gc19yZXQgPSBcdTAwMWJbMzg7NTsyOG1tYXhcdTAwMWJbMzltKFx1MDAxYlszODs1OzI4bWFic1x1MDAxYlszOW0obnAubG9nKHNfaGlnaC9yZWZfcHJpY2UpKSwgXHUwMDFiWzM4OzU7MjhtYWJzXHUwMDFiWzM5bShucC5sb2coc19sb3cvcmVmX3ByaWNlKSkpXG5cdTAwMWJbMzJtICAgIDMwM1x1MDAxYlszOW0gY3VycmVudF96ID0gc19yZXQgLyAoYm94X3N0ZCAqIHNxcnRfanVtcClcblxuXHUwMDFiWzM2bUZpbGUgXHUwMDFiWzM5bVx1MDAxYlszMm1+L3NoYXJlZC9lYXN0U3luYy9weUVhc3QvcHJvX3ZlcnNpb24vLnZlbnYvbGliL3B5dGhvbjMuMTMvc2l0ZS1wYWNrYWdlcy9wYW5kYXMvY29yZS9pbmRleGluZy5weToxMTkyXHUwMDFiWzM5bSwgaW4gXHUwMDFiWzM2bV9Mb2NhdGlvbkluZGV4ZXIuX19nZXRpdGVtX19cdTAwMWJbMzltXHUwMDFiWzM0bShzZWxmLCBrZXkpXHUwMDFiWzM5bVxuXHUwMDFiWzMybSAgIDExOTBcdTAwMWJbMzltIG1heWJlX2NhbGxhYmxlID0gY29tLmFwcGx5X2lmX2NhbGxhYmxlKGtleSwgXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0ub2JqKVxuXHUwMDFiWzMybSAgIDExOTFcdTAwMWJbMzltIG1heWJlX2NhbGxhYmxlID0gXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0uX2NoZWNrX2RlcHJlY2F0ZWRfY2FsbGFibGVfdXNhZ2Uoa2V5LCBtYXliZV9jYWxsYWJsZSlcblx1MDAxYlszMm0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTExOTJcdTAwMWJbMzltIFx1MDAxYlszODs1OzI4OzAxbXJldHVyblx1MDAxYlszOTswMG0gXHUwMDFiWzM4OzU7Mjg7NDNtc2VsZlx1MDAxYlszOTs0OW1cdTAwMWJbNDNtLlx1MDAxYls0OW1cdTAwMWJbNDNtX2dldGl0ZW1fYXhpc1x1MDAxYls0OW1cdTAwMWJbNDNtKFx1MDAxYls0OW1cdTAwMWJbNDNtbWF5YmVfY2FsbGFibGVcdTAwMWJbNDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbWF4aXNcdTAwMWJbNDltXHUwMDFiWzQzbT1cdTAwMWJbNDltXHUwMDFiWzQzbWF4aXNcdTAwMWJbNDltXHUwMDFiWzQzbSlcdTAwMWJbNDltXG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvaW5kZXhpbmcucHk6MTQyMVx1MDAxYlszOW0sIGluIFx1MDAxYlszNm1fTG9jSW5kZXhlci5fZ2V0aXRlbV9heGlzXHUwMDFiWzM5bVx1MDAxYlszNG0oc2VsZiwga2V5LCBheGlzKVx1MDAxYlszOW1cblx1MDAxYlszMm0gICAxNDE4XHUwMDFiWzM5bSAgICAgXHUwMDFiWzM4OzU7Mjg7MDFtaWZcdTAwMWJbMzk7MDBtIFx1MDAxYlszODs1OzI4bWhhc2F0dHJcdTAwMWJbMzltKGtleSwgXHUwMDFiWzMzbVwiXHUwMDFiWzM5bVx1MDAxYlszM21uZGltXHUwMDFiWzM5bVx1MDAxYlszM21cIlx1MDAxYlszOW0pIFx1MDAxYlszODs1OzEyOTswMW1hbmRcdTAwMWJbMzk7MDBtIGtleS5uZGltID4gXHUwMDFiWzMybTFcdTAwMWJbMzltOlxuXHUwMDFiWzMybSAgIDE0MTlcdTAwMWJbMzltICAgICAgICAgXHUwMDFiWzM4OzU7Mjg7MDFtcmFpc2VcdTAwMWJbMzk7MDBtIFx1MDAxYlszODs1OzE2NzswMW1WYWx1ZUVycm9yXHUwMDFiWzM5OzAwbShcdTAwMWJbMzNtXCJcdTAwMWJbMzltXHUwMDFiWzMzbUNhbm5vdCBpbmRleCB3aXRoIG11bHRpZGltZW5zaW9uYWwga2V5XHUwMDFiWzM5bVx1MDAxYlszM21cIlx1MDAxYlszOW0pXG5cdTAwMWJbMzJtLT4gXHUwMDFiWzM5bVx1MDAxYlszMm0xNDIxXHUwMDFiWzM5bSAgICAgXHUwMDFiWzM4OzU7Mjg7MDFtcmV0dXJuXHUwMDFiWzM5OzAwbSBcdTAwMWJbMzg7NTsyODs0M21zZWxmXHUwMDFiWzM5OzQ5bVx1MDAxYls0M20uXHUwMDFiWzQ5bVx1MDAxYls0M21fZ2V0aXRlbV9pdGVyYWJsZVx1MDAxYls0OW1cdTAwMWJbNDNtKFx1MDAxYls0OW1cdTAwMWJbNDNta2V5XHUwMDFiWzQ5bVx1MDAxYls0M20sXHUwMDFiWzQ5bVx1MDAxYls0M20gXHUwMDFiWzQ5bVx1MDAxYls0M21heGlzXHUwMDFiWzQ5bVx1MDAxYls0M209XHUwMDFiWzQ5bVx1MDAxYls0M21heGlzXHUwMDFiWzQ5bVx1MDAxYls0M20pXHUwMDFiWzQ5bVxuXHUwMDFiWzMybSAgIDE0MjNcdTAwMWJbMzltIFx1MDAxYlszODs1OzY2OzAzbSMgbmVzdGVkIHR1cGxlIHNsaWNpbmdcdTAwMWJbMzk7MDBtXG5cdTAwMWJbMzJtICAgMTQyNFx1MDAxYlszOW0gXHUwMDFiWzM4OzU7Mjg7MDFtaWZcdTAwMWJbMzk7MDBtIGlzX25lc3RlZF90dXBsZShrZXksIGxhYmVscyk6XG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvaW5kZXhpbmcucHk6MTM2MVx1MDAxYlszOW0sIGluIFx1MDAxYlszNm1fTG9jSW5kZXhlci5fZ2V0aXRlbV9pdGVyYWJsZVx1MDAxYlszOW1cdTAwMWJbMzRtKHNlbGYsIGtleSwgYXhpcylcdTAwMWJbMzltXG5cdTAwMWJbMzJtICAgMTM1OFx1MDAxYlszOW0gXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0uX3ZhbGlkYXRlX2tleShrZXksIGF4aXMpXG5cdTAwMWJbMzJtICAgMTM2MFx1MDAxYlszOW0gXHUwMDFiWzM4OzU7NjY7MDNtIyBBIGNvbGxlY3Rpb24gb2Yga2V5c1x1MDAxYlszOTswMG1cblx1MDAxYlszMm0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTEzNjFcdTAwMWJbMzltIGtleWFyciwgaW5kZXhlciA9IFx1MDAxYlszODs1OzI4OzQzbXNlbGZcdTAwMWJbMzk7NDltXHUwMDFiWzQzbS5cdTAwMWJbNDltXHUwMDFiWzQzbV9nZXRfbGlzdGxpa2VfaW5kZXhlclx1MDAxYls0OW1cdTAwMWJbNDNtKFx1MDAxYls0OW1cdTAwMWJbNDNta2V5XHUwMDFiWzQ5bVx1MDAxYls0M20sXHUwMDFiWzQ5bVx1MDAxYls0M20gXHUwMDFiWzQ5bVx1MDAxYls0M21heGlzXHUwMDFiWzQ5bVx1MDAxYls0M20pXHUwMDFiWzQ5bVxuXHUwMDFiWzMybSAgIDEzNjJcdTAwMWJbMzltIFx1MDAxYlszODs1OzI4OzAxbXJldHVyblx1MDAxYlszOTswMG0gXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0ub2JqLl9yZWluZGV4X3dpdGhfaW5kZXhlcnMoXG5cdTAwMWJbMzJtICAgMTM2M1x1MDAxYlszOW0gICAgIHtheGlzOiBba2V5YXJyLCBpbmRleGVyXX0sIGNvcHk9XHUwMDFiWzM4OzU7Mjg7MDFtVHJ1ZVx1MDAxYlszOTswMG0sIGFsbG93X2R1cHM9XHUwMDFiWzM4OzU7Mjg7MDFtVHJ1ZVx1MDAxYlszOTswMG1cblx1MDAxYlszMm0gICAxMzY0XHUwMDFiWzM5bSApXG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvaW5kZXhpbmcucHk6MTU1OVx1MDAxYlszOW0sIGluIFx1MDAxYlszNm1fTG9jSW5kZXhlci5fZ2V0X2xpc3RsaWtlX2luZGV4ZXJcdTAwMWJbMzltXHUwMDFiWzM0bShzZWxmLCBrZXksIGF4aXMpXHUwMDFiWzM5bVxuXHUwMDFiWzMybSAgIDE1NTZcdTAwMWJbMzltIGF4ID0gXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0ub2JqLl9nZXRfYXhpcyhheGlzKVxuXHUwMDFiWzMybSAgIDE1NTdcdTAwMWJbMzltIGF4aXNfbmFtZSA9IFx1MDAxYlszODs1OzI4bXNlbGZcdTAwMWJbMzltLm9iai5fZ2V0X2F4aXNfbmFtZShheGlzKVxuXHUwMDFiWzMybS0+IFx1MDAxYlszOW1cdTAwMWJbMzJtMTU1OVx1MDAxYlszOW0ga2V5YXJyLCBpbmRleGVyID0gXHUwMDFiWzQzbWF4XHUwMDFiWzQ5bVx1MDAxYls0M20uXHUwMDFiWzQ5bVx1MDAxYls0M21fZ2V0X2luZGV4ZXJfc3RyaWN0XHUwMDFiWzQ5bVx1MDAxYls0M20oXHUwMDFiWzQ5bVx1MDAxYls0M21rZXlcdTAwMWJbNDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbWF4aXNfbmFtZVx1MDAxYls0OW1cdTAwMWJbNDNtKVx1MDAxYls0OW1cblx1MDAxYlszMm0gICAxNTYxXHUwMDFiWzM5bSBcdTAwMWJbMzg7NTsyODswMW1yZXR1cm5cdTAwMWJbMzk7MDBtIGtleWFyciwgaW5kZXhlclxuXG5cdTAwMWJbMzZtRmlsZSBcdTAwMWJbMzltXHUwMDFiWzMybX4vc2hhcmVkL2Vhc3RTeW5jL3B5RWFzdC9wcm9fdmVyc2lvbi8udmVudi9saWIvcHl0aG9uMy4xMy9zaXRlLXBhY2thZ2VzL3BhbmRhcy9jb3JlL2luZGV4ZXMvYmFzZS5weTo2MjE0XHUwMDFiWzM5bSwgaW4gXHUwMDFiWzM2bUluZGV4Ll9nZXRfaW5kZXhlcl9zdHJpY3RcdTAwMWJbMzltXHUwMDFiWzM0bShzZWxmLCBrZXksIGF4aXNfbmFtZSlcdTAwMWJbMzltXG5cdTAwMWJbMzJtICAgNjIxMFx1MDAxYlszOW0gICAgIGtleWFyciwgaW5kZXhlciwgbmV3X2luZGV4ZXIgPSBcdTAwMWJbMzg7NTsyOG1zZWxmXHUwMDFiWzM5bS5fcmVpbmRleF9ub25fdW5pcXVlKGtleWFycilcblx1MDAxYlszMm0gICA2MjEyXHUwMDFiWzM5bSBcdTAwMWJbMzg7NTsyOG1zZWxmXHUwMDFiWzM5bS5fcmFpc2VfaWZfbWlzc2luZyhrZXlhcnIsIGluZGV4ZXIsIGF4aXNfbmFtZSlcblx1MDAxYlszMm0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTYyMTRcdTAwMWJbMzltIGtleWFyciA9IFx1MDAxYlszODs1OzI4OzQzbXNlbGZcdTAwMWJbMzk7NDltXHUwMDFiWzQzbS5cdTAwMWJbNDltXHUwMDFiWzQzbXRha2VcdTAwMWJbNDltXHUwMDFiWzQzbShcdTAwMWJbNDltXHUwMDFiWzQzbWluZGV4ZXJcdTAwMWJbNDltXHUwMDFiWzQzbSlcdTAwMWJbNDltXG5cdTAwMWJbMzJtICAgNjIxNVx1MDAxYlszOW0gXHUwMDFiWzM4OzU7Mjg7MDFtaWZcdTAwMWJbMzk7MDBtIFx1MDAxYlszODs1OzI4bWlzaW5zdGFuY2VcdTAwMWJbMzltKGtleSwgSW5kZXgpOlxuXHUwMDFiWzMybSAgIDYyMTZcdTAwMWJbMzltICAgICBcdTAwMWJbMzg7NTs2NjswM20jIEdIIDQyNzkwIC0gUHJlc2VydmUgbmFtZSBmcm9tIGFuIEluZGV4XHUwMDFiWzM5OzAwbVxuXHUwMDFiWzMybSAgIDYyMTdcdTAwMWJbMzltICAgICBrZXlhcnIubmFtZSA9IGtleS5uYW1lXG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvaW5kZXhlcy9kYXRldGltZWxpa2UucHk6ODQxXHUwMDFiWzM5bSwgaW4gXHUwMDFiWzM2bURhdGV0aW1lVGltZWRlbHRhTWl4aW4udGFrZVx1MDAxYlszOW1cdTAwMWJbMzRtKHNlbGYsIGluZGljZXMsIGF4aXMsIGFsbG93X2ZpbGwsIGZpbGxfdmFsdWUsICoqa3dhcmdzKVx1MDAxYlszOW1cblx1MDAxYlszMm0gICAgODM5XHUwMDFiWzM5bSBtYXliZV9zbGljZSA9IGxpYi5tYXliZV9pbmRpY2VzX3RvX3NsaWNlKGluZGljZXMsIFx1MDAxYlszODs1OzI4bWxlblx1MDAxYlszOW0oXHUwMDFiWzM4OzU7Mjhtc2VsZlx1MDAxYlszOW0pKVxuXHUwMDFiWzMybSAgICA4NDBcdTAwMWJbMzltIFx1MDAxYlszODs1OzI4OzAxbWlmXHUwMDFiWzM5OzAwbSBcdTAwMWJbMzg7NTsyOG1pc2luc3RhbmNlXHUwMDFiWzM5bShtYXliZV9zbGljZSwgXHUwMDFiWzM4OzU7Mjhtc2xpY2VcdTAwMWJbMzltKTpcblx1MDAxYlszMm0tLT4gXHUwMDFiWzM5bVx1MDAxYlszMm04NDFcdTAwMWJbMzltICAgICBmcmVxID0gXHUwMDFiWzM4OzU7Mjg7NDNtc2VsZlx1MDAxYlszOTs0OW1cdTAwMWJbNDNtLlx1MDAxYls0OW1cdTAwMWJbNDNtX2RhdGFcdTAwMWJbNDltXHUwMDFiWzQzbS5cdTAwMWJbNDltXHUwMDFiWzQzbV9nZXRfZ2V0aXRlbV9mcmVxXHUwMDFiWzQ5bVx1MDAxYls0M20oXHUwMDFiWzQ5bVx1MDAxYls0M21tYXliZV9zbGljZVx1MDAxYls0OW1cdTAwMWJbNDNtKVx1MDAxYls0OW1cblx1MDAxYlszMm0gICAgODQyXHUwMDFiWzM5bSAgICAgcmVzdWx0Ll9kYXRhLl9mcmVxID0gZnJlcVxuXHUwMDFiWzMybSAgICA4NDNcdTAwMWJbMzltIFx1MDAxYlszODs1OzI4OzAxbXJldHVyblx1MDAxYlszOTswMG0gcmVzdWx0XG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvYXJyYXlzL2RhdGV0aW1lbGlrZS5weTo0MTdcdTAwMWJbMzltLCBpbiBcdTAwMWJbMzZtRGF0ZXRpbWVMaWtlQXJyYXlNaXhpbi5fZ2V0X2dldGl0ZW1fZnJlcVx1MDAxYlszOW1cdTAwMWJbMzRtKHNlbGYsIGtleSlcdTAwMWJbMzltXG5cdTAwMWJbMzJtICAgIDQxNVx1MDAxYlszOW0gICAgIGZyZXEgPSBcdTAwMWJbMzg7NTsyODswMW1Ob25lXHUwMDFiWzM5OzAwbVxuXHUwMDFiWzMybSAgICA0MTZcdTAwMWJbMzltIFx1MDAxYlszODs1OzI4OzAxbWVsc2VcdTAwMWJbMzk7MDBtOlxuXHUwMDFiWzMybS0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTQxN1x1MDAxYlszOW0gICAgIGtleSA9IFx1MDAxYls0M21jaGVja19hcnJheV9pbmRleGVyXHUwMDFiWzQ5bVx1MDAxYls0M20oXHUwMDFiWzQ5bVx1MDAxYlszODs1OzI4OzQzbXNlbGZcdTAwMWJbMzk7NDltXHUwMDFiWzQzbSxcdTAwMWJbNDltXHUwMDFiWzQzbSBcdTAwMWJbNDltXHUwMDFiWzQzbWtleVx1MDAxYls0OW1cdTAwMWJbNDNtKVx1MDAxYls0OW0gIFx1MDAxYlszODs1OzY2OzAzbSMgbWF5YmUgbmRhcnJheVtib29sXSAtPiBzbGljZVx1MDAxYlszOTswMG1cblx1MDAxYlszMm0gICAgNDE4XHUwMDFiWzM5bSAgICAgZnJlcSA9IFx1MDAxYlszODs1OzI4OzAxbU5vbmVcdTAwMWJbMzk7MDBtXG5cdTAwMWJbMzJtICAgIDQxOVx1MDAxYlszOW0gICAgIFx1MDAxYlszODs1OzI4OzAxbWlmXHUwMDFiWzM5OzAwbSBcdTAwMWJbMzg7NTsyOG1pc2luc3RhbmNlXHUwMDFiWzM5bShrZXksIFx1MDAxYlszODs1OzI4bXNsaWNlXHUwMDFiWzM5bSk6XG5cblx1MDAxYlszNm1GaWxlIFx1MDAxYlszOW1cdTAwMWJbMzJtfi9zaGFyZWQvZWFzdFN5bmMvcHlFYXN0L3Byb192ZXJzaW9uLy52ZW52L2xpYi9weXRob24zLjEzL3NpdGUtcGFja2FnZXMvcGFuZGFzL2NvcmUvaW5kZXhlcnMvdXRpbHMucHk6NTE3XHUwMDFiWzM5bSwgaW4gXHUwMDFiWzM2bWNoZWNrX2FycmF5X2luZGV4ZXJcdTAwMWJbMzltXHUwMDFiWzM0bShhcnJheSwgaW5kZXhlcilcdTAwMWJbMzltXG5cdTAwMWJbMzJtICAgIDUxMVx1MDAxYlszOW0gXHUwMDFiWzM4OzU7Mjg7MDFtZnJvbVx1MDAxYlszOTswMG1cdTAwMWJbMzg7NTsyNTBtIFx1MDAxYlszOW1cdTAwMWJbMzQ7MDFtcGFuZGFzXHUwMDFiWzM5OzAwbVx1MDAxYlszNDswMW0uXHUwMDFiWzM5OzAwbVx1MDAxYlszNDswMW1jb3JlXHUwMDFiWzM5OzAwbVx1MDAxYlszNDswMW0uXHUwMDFiWzM5OzAwbVx1MDAxYlszNDswMW1jb25zdHJ1Y3Rpb25cdTAwMWJbMzk7MDBtXHUwMDFiWzM4OzU7MjUwbSBcdTAwMWJbMzltXHUwMDFiWzM4OzU7Mjg7MDFtaW1wb3J0XHUwMDFiWzM5OzAwbSBhcnJheSBcdTAwMWJbMzg7NTsyODswMW1hc1x1MDAxYlszOTswMG0gcGRfYXJyYXlcblx1MDAxYlszMm0gICAgNTEzXHUwMDFiWzM5bSBcdTAwMWJbMzg7NTs2NjswM20jIHdoYXRldmVyIGlzIG5vdCBhbiBhcnJheS1saWtlIGlzIHJldHVybmVkIGFzLWlzIChwb3NzaWJsZSB2YWxpZCBhcnJheVx1MDAxYlszOTswMG1cblx1MDAxYlszMm0gICAgNTE0XHUwMDFiWzM5bSBcdTAwMWJbMzg7NTs2NjswM20jIGluZGV4ZXJzIHRoYXQgYXJlIG5vdCBhcnJheS1saWtlOiBpbnRlZ2VyLCBzbGljZSwgRWxsaXBzaXMsIE5vbmUpXHUwMDFiWzM5OzAwbVxuXHUwMDFiWzMybSAgICA1MTVcdTAwMWJbMzltIFx1MDAxYlszODs1OzY2OzAzbSMgSW4gdGhpcyBjb250ZXh0LCB0dXBsZXMgYXJlIG5vdCBjb25zaWRlcmVkIGFzIGFycmF5LWxpa2UsIGFzIHRoZXkgaGF2ZVx1MDAxYlszOTswMG1cblx1MDAxYlszMm0gICAgNTE2XHUwMDFiWzM5bSBcdTAwMWJbMzg7NTs2NjswM20jIGEgc3BlY2lmaWMgbWVhbmluZyBpbiBpbmRleGluZyAobXVsdGktZGltZW5zaW9uYWwgaW5kZXhpbmcpXHUwMDFiWzM5OzAwbVxuXHUwMDFiWzMybS0tPiBcdTAwMWJbMzltXHUwMDFiWzMybTUxN1x1MDAxYlszOW0gXHUwMDFiWzM4OzU7Mjg7MDFtaWZcdTAwMWJbMzk7MDBtIFx1MDAxYls0M21pc19saXN0X2xpa2VcdTAwMWJbNDltXHUwMDFiWzQzbShcdTAwMWJbNDltXHUwMDFiWzQzbWluZGV4ZXJcdTAwMWJbNDltXHUwMDFiWzQzbSlcdTAwMWJbNDltOlxuXHUwMDFiWzMybSAgICA1MThcdTAwMWJbMzltICAgICBcdTAwMWJbMzg7NTsyODswMW1pZlx1MDAxYlszOTswMG0gXHUwMDFiWzM4OzU7MjhtaXNpbnN0YW5jZVx1MDAxYlszOW0oaW5kZXhlciwgXHUwMDFiWzM4OzU7MjhtdHVwbGVcdTAwMWJbMzltKTpcblx1MDAxYlszMm0gICAgNTE5XHUwMDFiWzM5bSAgICAgICAgIFx1MDAxYlszODs1OzI4OzAxbXJldHVyblx1MDAxYlszOTswMG0gaW5kZXhlclxuXG5cdTAwMWJbMzFtS2V5Ym9hcmRJbnRlcnJ1cHRcdTAwMWJbMzltOiAiCn0=\"},\"mime\":\"application/vnd.code.notebook.error\"}]}],\"source\":\"import pandas as pd\\nfrom pathlib import Path\\nfrom typing import Optional\\nfrom data_pipeline import load_data  # This just loads the data and cleans it\\nfrom featureEngineer import FeatureEngineer\\nfrom targetEngineer import ExpirationTargetEngineer\\nfrom ML_setup import CONFIG\\nfrom ML_general_tools import *\\nfrom pathlib import Path\\n\\nprint(\\\"Imports and configuration ready\\\")\\n\\n# Build features, targets, and combined dataframe\\nraw_history = load_data(CONFIG[\\\"data\\\"][\\\"path\\\"])\\nhistory_slice = raw_history[:]\\n\\nfeature_params = dict(CONFIG[\\\"features\\\"][\\\"params\\\"])\\nheavy_cache_cfg = CONFIG[\\\"features\\\"].get(\\\"heavy_cache\\\", {})\\nheavy_cache_root = Path(heavy_cache_cfg.get(\\\"directory\\\", \\\"cache/heavy_features\\\"))\\n\\ncurrent_output_root_str = CONFIG[\\\"output\\\"][\\\"directory\\\"]\\ncurrent_output_root_path = Path(current_output_root_str)\\n\\npaths = {\\n    \\\"root\\\": current_output_root_path,\\n    \\\"feature_selection\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"features\\\"],\\n    \\\"trained_models\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"models\\\"],\\n    \\\"hpt_studies\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"hpt\\\"],\\n    \\\"feature_cache\\\": current_output_root_path / CONFIG[\\\"output\\\"][\\\"subdirectories\\\"][\\\"cache\\\"]\\n}\\n\\n\\ncache_dir = heavy_cache_root\\ncache_dir.mkdir(parents=True, exist_ok=True)\\ncache_files = sorted(cache_dir.glob(\\\"heavy_features_v*.pkl\\\"))\\ncache_ready = bool(cache_files)\\nif cache_ready:\\n    print(f\\\"Heavy cache ready: {cache_files[-1].name} (total {len(cache_files)}) in {cache_dir}\\\")\\nelse:\\n    print(f\\\"No heavy cache file found in {cache_dir}; initial fit will populate.\\\")\\n\\n## Feture Engineering\\nfe = FeatureEngineer(verbose=feature_params.get(\\\"verbose\\\", False), **{k: v for k, v in feature_params.items() if k != \\\"verbose\\\"})\\n\\n## cache\\ncache_ready = True  # Force rebuild for testing\\n\\nmanual_features = None\\nif cache_ready and fe.heavy_cache.load():\\n    print(\\\"Loaded heavy cache payload from disk; skipping rebuild.\\\")\\n    fe._heavy_payload = fe.heavy_cache.payload\\n    reference = fe._prepare_reference_frame(history_slice)\\n    fe._full_reference = reference\\n    manual_features = fe._compute_all_features(reference, build_heavy=False)\\n    fe.feature_names_out_ = manual_features.columns.tolist()\\n    fe._reference_features = manual_features\\n    print(f\\\"Manual features shape from cache: {manual_features.shape}\\\")\\nelse:\\n    print(\\\"Heavy cache not available or failed to load; running full fit.\\\")\\n    verbose_flag = feature_params.pop(\\\"verbose\\\", False)\\n    fe = FeatureEngineer(verbose=verbose_flag, **feature_params)\\n    fe.fit(history_slice)\\n    manual_features = fe.transform(history_slice)\\n\\nfeature_engineer = fe\\nfeatures = manual_features.copy()\\n\\n## Add targets standard expiration targets\\n# target_engineer = ExpirationTargetEngineer(**CONFIG[\\\"targets\\\"][\\\"params\\\"])\\n# target_engineer.fit(features)\\n# targets = target_engineer.transform(features)\\n\\n## 2a. Volatility Regime Target Engineering Test ---\\nfrom targetEngineer import VolatilityRegimeEngineer\\n\\ndf_train = features.copy()\\n\\n# Instantiate with your parameters\\nregime_engineer = VolatilityRegimeEngineer(\\n    lookback_window=24*3,    # 3 days lookback for vol\\n    seasonal_window=24*30,   # 30 days to learn patterns\\n    forward_window=24,       # 24h classification\\n    trend_std=1.2,           # 1.2 daily sigmas\\n    jump_std=3.0,            # 3.0 daily sigmas (scaled internally for 6h window)\\n    jump_speed_window=6,     # 6h window for jump detection\\n\\n    # Hardening Parameters\\n    trend_min_efficiency=0.15, # Allows looser/messier trends\\n    trend_min_r2=0.6           # Requires moderate linear fit\\n)\\n\\n# Run Fit/Transform\\nregime_engineer.fit(df_train)\\ntargets = regime_engineer.transform(df_train)\\n\\n# Check the distribution\\ndist = regime_engineer.get_regime_distribution(df_train)\\nprint(dist)\\n\\n\\ninitial_feature_names = list(features.columns)\\n\\n# Generate targets (your existing logic)\\nprint(initial_feature_names)\\n\\n\\n## deop price columns from features\\n# drop_cols = [col for col in ['o', 'h', 'l', 'c', 'volCcy'] if col in features.columns]\\n# if drop_cols: features = features.drop(columns=drop_cols)\\n\\n\\n# Combine\\ncombined_df = pd.concat([features, targets], axis=1)\\n\",\"internalMetadata\":{\"executionOrder\":3,\"executionId\":\"7e9fbc2e-6262-42d9-999a-ed3f77899505\",\"runStartTime\":1764178546918,\"runEndTime\":1764178830444,\"lastRunSuccess\":false,\"renderDuration\":{\"vscode.builtin-renderer\":4},\"runStartTimeAdjustment\":0,\"internalId\":\"d9559027\"}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":1,\"id\":\"030f489c\",\"metadata\":{}},\"outputs\":[{\"outputId\":\"49251b87-6527-4753-80ce-d9f7c4cb442d\",\"metadata\":{\"outputType\":\"error\",\"originalError\":{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'features' is not defined\",\"traceback\":[\"\\u001b[31m---------------------------------------------------------------------------\\u001b[39m\",\"\\u001b[31mNameError\\u001b[39m                                 Traceback (most recent call last)\",\"\\u001b[36mCell\\u001b[39m\\u001b[36m \\u001b[39m\\u001b[32mIn[1]\\u001b[39m\\u001b[32m, line 2\\u001b[39m\\n\\u001b[32m      1\\u001b[39m \\u001b[38;5;66;03m# Find rows with any NaN values in features\\u001b[39;00m\\n\\u001b[32m----> \\u001b[39m\\u001b[32m2\\u001b[39m nan_mask = \\u001b[43mfeatures\\u001b[49m.isna().any(axis=\\u001b[32m1\\u001b[39m)\\n\\u001b[32m      3\\u001b[39m features_with_nans = features[nan_mask]\\n\",\"\\u001b[31mNameError\\u001b[39m: name 'features' is not defined\"]}},\"outputs\":[{\"data\":{\"type\":\"ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d\",\"data\":\"ewoJIm5hbWUiOiAiTmFtZUVycm9yIiwKCSJtZXNzYWdlIjogIm5hbWUgJ2ZlYXR1cmVzJyBpcyBub3QgZGVmaW5lZCIsCgkic3RhY2siOiAiXHUwMDFiWzMxbS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVx1MDAxYlszOW1cblx1MDAxYlszMW1OYW1lRXJyb3JcdTAwMWJbMzltICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJhY2ViYWNrIChtb3N0IHJlY2VudCBjYWxsIGxhc3QpXG5cdTAwMWJbMzZtQ2VsbFx1MDAxYlszOW1cdTAwMWJbMzZtIFx1MDAxYlszOW1cdTAwMWJbMzJtSW5bMV1cdTAwMWJbMzltXHUwMDFiWzMybSwgbGluZSAyXHUwMDFiWzM5bVxuXHUwMDFiWzMybSAgICAgIDFcdTAwMWJbMzltIFx1MDAxYlszODs1OzY2OzAzbSMgRmluZCByb3dzIHdpdGggYW55IE5hTiB2YWx1ZXMgaW4gZmVhdHVyZXNcdTAwMWJbMzk7MDBtXG5cdTAwMWJbMzJtLS0tLT4gXHUwMDFiWzM5bVx1MDAxYlszMm0yXHUwMDFiWzM5bSBuYW5fbWFzayA9IFx1MDAxYls0M21mZWF0dXJlc1x1MDAxYls0OW0uaXNuYSgpLmFueShheGlzPVx1MDAxYlszMm0xXHUwMDFiWzM5bSlcblx1MDAxYlszMm0gICAgICAzXHUwMDFiWzM5bSBmZWF0dXJlc193aXRoX25hbnMgPSBmZWF0dXJlc1tuYW5fbWFza11cblxuXHUwMDFiWzMxbU5hbWVFcnJvclx1MDAxYlszOW06IG5hbWUgJ2ZlYXR1cmVzJyBpcyBub3QgZGVmaW5lZCIKfQ==\"},\"mime\":\"application/vnd.code.notebook.error\"}]}],\"mime\":\"text/plain\",\"source\":\"\\n# Find rows with any NaN values in features\\nnan_mask = features.isna().any(axis=1)\\nfeatures_with_nans = features[nan_mask]\\n\\n\",\"internalMetadata\":{\"internalId\":\"8d03f25f\",\"runStartTimeAdjustment\":0,\"executionId\":\"4b5a9213-29e4-4548-90bd-298b8efc8811\",\"runStartTime\":1764178353998,\"runEndTime\":1764178354110,\"lastRunSuccess\":false,\"executionOrder\":1,\"renderDuration\":{\"vscode.builtin-renderer\":1},\"error\":{\"name\":\"NameError\",\"message\":\"name 'features' is not defined\",\"stack\":\"\\u001b[31m---------------------------------------------------------------------------\\u001b[39m\\n\\u001b[31mNameError\\u001b[39m                                 Traceback (most recent call last)\\n\\u001b[36mCell\\u001b[39m\\u001b[36m \\u001b[39m\\u001b[32mIn[1]\\u001b[39m\\u001b[32m, line 2\\u001b[39m\\n\\u001b[32m      1\\u001b[39m \\u001b[38;5;66;03m# Find rows with any NaN values in features\\u001b[39;00m\\n\\u001b[32m----> \\u001b[39m\\u001b[32m2\\u001b[39m nan_mask = \\u001b[43mfeatures\\u001b[49m.isna().any(axis=\\u001b[32m1\\u001b[39m)\\n\\u001b[32m      3\\u001b[39m features_with_nans = features[nan_mask]\\n\\n\\u001b[31mNameError\\u001b[39m: name 'features' is not defined\",\"location\":{\"startLineNumber\":1,\"startColumn\":0,\"endLineNumber\":1,\"endColumn\":0},\"uri\":{\"$mid\":1,\"fsPath\":\"/home/east/shared/eastSync/pyEast/pro_version/targeting_volatility.ipynb\",\"external\":\"vscode-notebook-cell:/home/east/shared/eastSync/pyEast/pro_version/targeting_volatility.ipynb#X12sZmlsZQ%3D%3D\",\"path\":\"/home/east/shared/eastSync/pyEast/pro_version/targeting_volatility.ipynb\",\"scheme\":\"vscode-notebook-cell\",\"fragment\":\"X12sZmlsZQ==\"}}}},{\"cellKind\":2,\"language\":\"python\",\"metadata\":{\"execution_count\":null,\"id\":\"aea14ab6\",\"metadata\":{}},\"outputs\":[],\"mime\":\"text/plain\",\"source\":\"\\n\\n# Clean combined dataframe - drop first month and last 11 rows (minimal cleaning for small dataset)\\nmonths_to_drop = 1  # Only 1 month for small dataset\\ntail_rows_to_drop = 11\\n\\ncutoff = combined_df.index.min() + pd.DateOffset(months=months_to_drop)\\nprint(f\\\"Removing data before {cutoff:%Y-%m-%d} (first {months_to_drop} months)\\\")\\ncombined_df_clean = combined_df.loc[combined_df.index >= cutoff]\\n\\nif tail_rows_to_drop > 0:\\n    print(f\\\"Dropping last {tail_rows_to_drop} rows to avoid trailing NaNs\\\")\\n    combined_df_clean = combined_df_clean.iloc[:-tail_rows_to_drop]\\n\\nprint(f\\\"Rows after cleaning: {len(combined_df_clean)} (from {combined_df_clean.index[0]} to {combined_df_clean.index[-1]})\\\")\\n\\n# Split into train/val/test (80/10/10)\\nn_samples = len(combined_df_clean)\\ntrain_end = int(n_samples * 0.8)\\nval_end = train_end + int(n_samples * 0.1)\\n\\n# Get feature and target columns\\nfeature_cols = features.columns.intersection(combined_df_clean.columns)\\ntarget_cols = targets.columns.intersection(combined_df_clean.columns)\\n\\nX_train = combined_df_clean[feature_cols].iloc[:train_end]\\nX_val = combined_df_clean[feature_cols].iloc[train_end:val_end]\\nX_test = combined_df_clean[feature_cols].iloc[val_end:]\\n\\ny_train = combined_df_clean[target_cols].iloc[:train_end]\\ny_val = combined_df_clean[target_cols].iloc[train_end:val_end]\\ny_test = combined_df_clean[target_cols].iloc[val_end:]\\n\\nprint(f\\\"\\\\nX shapes -> train {X_train.shape}, val {X_val.shape}, test {X_test.shape}\\\")\\nprint(f\\\"y shapes -> train {y_train.shape}, val {y_val.shape}, test {y_test.shape}\\\")\\n\\n# Quick NaN check on training data\\ntrain_nans = X_train.isna().sum()\\nif train_nans.sum() > 0:\\n    print(f\\\"\\\\n⚠ Training features with NaNs: {(train_nans > 0).sum()} columns\\\")\\n    print(f\\\"  Max NaNs in any column: {train_nans.max()} ({train_nans.max()/len(X_train):.1%})\\\")\\nelse:\\n    print(\\\"\\\\n✓ No NaNs in training features\\\")\\n\",\"internalMetadata\":{\"internalId\":\"8809a7a5\"}}],\"metadata\":{\"metadata\":{\"kernelspec\":{\"display_name\":\".venv\",\"language\":\"python\",\"name\":\"python3\"},\"language_info\":{\"codemirror_mode\":{\"name\":\"ipython\",\"version\":3},\"file_extension\":\".py\",\"mimetype\":\"text/x-python\",\"name\":\"python\",\"nbconvert_exporter\":\"python\",\"pygments_lexer\":\"ipython3\",\"version\":\"3.13.7\"}},\"nbformat\":4,\"nbformat_minor\":5}}"]